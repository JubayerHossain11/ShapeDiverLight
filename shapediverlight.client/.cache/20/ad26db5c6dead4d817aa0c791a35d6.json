{"id":"RCtN","dependencies":[{"name":"F:\\UpworkProjects\\ShapeDiverLight\\ShapeDiverLight\\shapediverlight.client\\node_modules\\@shapediver\\viewer.data-engine.geometry-engine\\dist\\gltfv2\\loaders\\BufferLoader.js.map","includedInParent":true,"mtime":1706476151957},{"name":"F:\\UpworkProjects\\ShapeDiverLight\\ShapeDiverLight\\shapediverlight.client\\node_modules\\@shapediver\\viewer.data-engine.geometry-engine\\src\\gltfv2\\loaders\\BufferLoader.ts","includedInParent":true,"mtime":1706476152557},{"name":"F:\\UpworkProjects\\ShapeDiverLight\\ShapeDiverLight\\shapediverlight.client\\package.json","includedInParent":true,"mtime":1706476652643},{"name":"F:\\UpworkProjects\\ShapeDiverLight\\ShapeDiverLight\\shapediverlight.client\\node_modules\\@shapediver\\viewer.data-engine.geometry-engine\\package.json","includedInParent":true,"mtime":1706476151913},{"name":"@shapediver/viewer.shared.services","loc":{"line":13,"column":41,"index":842},"parent":"F:\\UpworkProjects\\ShapeDiverLight\\ShapeDiverLight\\shapediverlight.client\\node_modules\\@shapediver\\viewer.data-engine.geometry-engine\\dist\\gltfv2\\loaders\\BufferLoader.js","resolved":"F:\\UpworkProjects\\ShapeDiverLight\\ShapeDiverLight\\shapediverlight.client\\node_modules\\@shapediver\\viewer.shared.services\\dist\\index.js"}],"generated":{"js":"\"use strict\";var e=this&&this.__awaiter||function(e,t,r,o){return new(r||(r=Promise))(function(n,i){function f(e){try{a(o.next(e))}catch(t){i(t)}}function s(e){try{a(o.throw(e))}catch(t){i(t)}}function a(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(f,s)}a((o=o.apply(e,t||[])).next())})};Object.defineProperty(exports,\"__esModule\",{value:!0}),exports.BufferLoader=void 0;const t=require(\"@shapediver/viewer.shared.services\");class r{constructor(e,r,o){this._content=e,this._body=r,this._baseUri=o,this._httpClient=t.HttpClient.instance,this._loaded={}}getBuffer(e){if(!this._content.buffers)throw new Error(\"BufferLoader.getBuffer: Buffers not available.\");if(!this._content.buffers[e])throw new Error(\"BufferLoader.getBuffer: Buffer not available.\");if(!this._loaded[e])throw new Error(\"BufferLoader.getBuffer: Buffer not loaded.\");return this._loaded[e]}load(){return e(this,void 0,void 0,function*(){if(!this._content.buffers)return;let e=[];for(let t=0;t<this._content.buffers.length;t++){const r=t,o=this._content.buffers[r];if(o.type&&\"arraybuffer\"!==o.type)throw new Error(`BufferLoader.load: ${o.type} is not supported.`);if(void 0===o.uri&&0===r){if(!this._body)throw new Error(\"BufferLoader.load: Buffer not available.\");return void(this._loaded[r]=this._body)}const n=/^data:(.*?)(;base64)?,(.*)$/,i=o.uri.match(n);if(i){const e=!!i[2];let t=i[3];t=decodeURIComponent(t),e&&(t=atob(t));const o=new Uint8Array(t.length);for(let r=0;r<t.length;r++)o[r]=t.charCodeAt(r);this._loaded[r]=o.buffer}else{let t=this._httpClient.get(this._baseUri+\"/\"+o.uri,{responseType:\"arraybuffer\"}).then(e=>{this._loaded[r]=e.data});e.push(t)}}yield Promise.all(e)})}}exports.BufferLoader=r;"},"sourceMaps":{"js":{"mappings":[{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":2,"column":0},"generated":{"line":1,"column":412}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":2,"column":0},"generated":{"line":1,"column":418}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":2,"column":0},"generated":{"line":1,"column":420}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":2,"column":0},"generated":{"line":1,"column":428}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":4,"column":0},"generated":{"line":1,"column":466}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":4,"column":13},"generated":{"line":1,"column":472}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":17,"column":4},"generated":{"line":1,"column":474}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":17,"column":33},"generated":{"line":1,"column":486}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":17,"column":61},"generated":{"line":1,"column":488}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":17,"column":90},"generated":{"line":1,"column":490}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":17,"column":33},"generated":{"line":1,"column":493}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":17,"column":33},"generated":{"line":1,"column":498}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":17,"column":33},"generated":{"line":1,"column":507}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":17,"column":61},"generated":{"line":1,"column":509}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":17,"column":61},"generated":{"line":1,"column":514}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":17,"column":61},"generated":{"line":1,"column":520}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":17,"column":90},"generated":{"line":1,"column":522}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":17,"column":90},"generated":{"line":1,"column":527}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":17,"column":90},"generated":{"line":1,"column":536}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":7,"column":21},"generated":{"line":1,"column":538}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":7,"column":21},"generated":{"line":1,"column":543}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":7,"column":47},"generated":{"line":1,"column":555}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":7,"column":47},"generated":{"line":1,"column":557}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":7,"column":58},"generated":{"line":1,"column":568}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":9,"column":12},"generated":{"line":1,"column":577}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":9,"column":12},"generated":{"line":1,"column":582}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":11,"column":8},"generated":{"line":1,"column":590}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":23,"column":11},"generated":{"line":1,"column":593}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":23,"column":21},"generated":{"line":1,"column":603}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":24,"column":8},"generated":{"line":1,"column":606}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":24,"column":13},"generated":{"line":1,"column":610}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":24,"column":18},"generated":{"line":1,"column":615}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":24,"column":27},"generated":{"line":1,"column":624}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":24,"column":36},"generated":{"line":1,"column":632}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":24,"column":42},"generated":{"line":1,"column":638}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":24,"column":46},"generated":{"line":1,"column":642}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":24,"column":52},"generated":{"line":1,"column":648}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":25,"column":8},"generated":{"line":1,"column":698}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":25,"column":13},"generated":{"line":1,"column":702}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":25,"column":18},"generated":{"line":1,"column":707}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":25,"column":27},"generated":{"line":1,"column":716}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":25,"column":35},"generated":{"line":1,"column":724}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":25,"column":46},"generated":{"line":1,"column":727}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":25,"column":52},"generated":{"line":1,"column":733}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":25,"column":56},"generated":{"line":1,"column":737}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":25,"column":62},"generated":{"line":1,"column":743}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":26,"column":8},"generated":{"line":1,"column":792}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":26,"column":13},"generated":{"line":1,"column":796}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":26,"column":18},"generated":{"line":1,"column":801}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":26,"column":26},"generated":{"line":1,"column":809}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":26,"column":37},"generated":{"line":1,"column":812}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":26,"column":43},"generated":{"line":1,"column":818}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":26,"column":47},"generated":{"line":1,"column":822}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":26,"column":53},"generated":{"line":1,"column":828}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":27,"column":8},"generated":{"line":1,"column":874}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":27,"column":15},"generated":{"line":1,"column":881}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":27,"column":20},"generated":{"line":1,"column":886}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":27,"column":28},"generated":{"line":1,"column":894}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":30,"column":17},"generated":{"line":1,"column":897}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":31,"column":8},"generated":{"line":1,"column":944}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":31,"column":13},"generated":{"line":1,"column":948}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":31,"column":18},"generated":{"line":1,"column":953}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":31,"column":27},"generated":{"line":1,"column":962}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":31,"column":36},"generated":{"line":1,"column":970}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":33,"column":8},"generated":{"line":1,"column":977}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":33,"column":12},"generated":{"line":1,"column":981}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":33,"column":40},"generated":{"line":1,"column":983}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":35,"column":8},"generated":{"line":1,"column":986}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":35,"column":13},"generated":{"line":1,"column":990}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":35,"column":17},"generated":{"line":1,"column":994}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":35,"column":21},"generated":{"line":1,"column":996}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":35,"column":24},"generated":{"line":1,"column":998}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":35,"column":28},"generated":{"line":1,"column":1000}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":35,"column":33},"generated":{"line":1,"column":1005}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":35,"column":42},"generated":{"line":1,"column":1014}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":35,"column":50},"generated":{"line":1,"column":1022}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":35,"column":58},"generated":{"line":1,"column":1029}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":35,"column":63},"generated":{"line":1,"column":1033}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":36,"column":12},"generated":{"line":1,"column":1034}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":36,"column":18},"generated":{"line":1,"column":1040}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":36,"column":29},"generated":{"line":1,"column":1042}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":37,"column":18},"generated":{"line":1,"column":1044}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":37,"column":27},"generated":{"line":1,"column":1046}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":37,"column":32},"generated":{"line":1,"column":1051}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":37,"column":41},"generated":{"line":1,"column":1060}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":37,"column":49},"generated":{"line":1,"column":1068}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":39,"column":12},"generated":{"line":1,"column":1071}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":39,"column":16},"generated":{"line":1,"column":1074}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":39,"column":23},"generated":{"line":1,"column":1076}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":39,"column":47},"generated":{"line":1,"column":1082}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":39,"column":31},"generated":{"line":1,"column":1098}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":39,"column":38},"generated":{"line":1,"column":1100}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":40,"column":16},"generated":{"line":1,"column":1105}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":40,"column":22},"generated":{"line":1,"column":1111}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":40,"column":26},"generated":{"line":1,"column":1115}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":40,"column":54},"generated":{"line":1,"column":1143}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":40,"column":61},"generated":{"line":1,"column":1145}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":44,"column":12},"generated":{"line":1,"column":1171}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":44,"column":31},"generated":{"line":1,"column":1179}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":44,"column":16},"generated":{"line":1,"column":1183}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":44,"column":23},"generated":{"line":1,"column":1185}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":44,"column":57},"generated":{"line":1,"column":1190}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":44,"column":44},"generated":{"line":1,"column":1194}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":44,"column":60},"generated":{"line":1,"column":1196}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":45,"column":16},"generated":{"line":1,"column":1197}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":45,"column":21},"generated":{"line":1,"column":1201}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":45,"column":26},"generated":{"line":1,"column":1206}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":45,"column":33},"generated":{"line":1,"column":1212}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":45,"column":39},"generated":{"line":1,"column":1218}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":45,"column":43},"generated":{"line":1,"column":1222}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":45,"column":49},"generated":{"line":1,"column":1228}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":47,"column":16},"generated":{"line":1,"column":1272}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":46,"column":16},"generated":{"line":1,"column":1284}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":46,"column":21},"generated":{"line":1,"column":1289}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":46,"column":29},"generated":{"line":1,"column":1297}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":46,"column":41},"generated":{"line":1,"column":1300}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":46,"column":46},"generated":{"line":1,"column":1305}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":50,"column":12},"generated":{"line":1,"column":1312}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":50,"column":18},"generated":{"line":1,"column":1318}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":50,"column":33},"generated":{"line":1,"column":1320}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":51,"column":18},"generated":{"line":1,"column":1350}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":51,"column":39},"generated":{"line":1,"column":1352}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":51,"column":46},"generated":{"line":1,"column":1354}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":51,"column":51},"generated":{"line":1,"column":1358}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":51,"column":57},"generated":{"line":1,"column":1364}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":54,"column":12},"generated":{"line":1,"column":1367}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":54,"column":16},"generated":{"line":1,"column":1370}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":54,"column":36},"generated":{"line":1,"column":1372}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":55,"column":16},"generated":{"line":1,"column":1373}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":55,"column":22},"generated":{"line":1,"column":1379}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":55,"column":35},"generated":{"line":1,"column":1383}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":55,"column":54},"generated":{"line":1,"column":1385}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":56,"column":16},"generated":{"line":1,"column":1388}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":56,"column":20},"generated":{"line":1,"column":1392}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":56,"column":27},"generated":{"line":1,"column":1394}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":56,"column":46},"generated":{"line":1,"column":1396}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":57,"column":16},"generated":{"line":1,"column":1399}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":57,"column":23},"generated":{"line":1,"column":1401}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":57,"column":42},"generated":{"line":1,"column":1420}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":58,"column":20},"generated":{"line":1,"column":1423}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":58,"column":30},"generated":{"line":1,"column":1427}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":58,"column":37},"generated":{"line":1,"column":1429}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":58,"column":42},"generated":{"line":1,"column":1434}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":60,"column":16},"generated":{"line":1,"column":1438}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":60,"column":22},"generated":{"line":1,"column":1444}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":60,"column":29},"generated":{"line":1,"column":1446}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":60,"column":33},"generated":{"line":1,"column":1450}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":60,"column":44},"generated":{"line":1,"column":1461}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":60,"column":49},"generated":{"line":1,"column":1463}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":61,"column":16},"generated":{"line":1,"column":1471}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":61,"column":21},"generated":{"line":1,"column":1475}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":61,"column":25},"generated":{"line":1,"column":1479}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":61,"column":29},"generated":{"line":1,"column":1481}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":61,"column":32},"generated":{"line":1,"column":1483}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":61,"column":36},"generated":{"line":1,"column":1485}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":61,"column":41},"generated":{"line":1,"column":1487}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":61,"column":49},"generated":{"line":1,"column":1494}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":62,"column":20},"generated":{"line":1,"column":1498}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":62,"column":25},"generated":{"line":1,"column":1500}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":62,"column":30},"generated":{"line":1,"column":1503}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":62,"column":35},"generated":{"line":1,"column":1505}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":62,"column":46},"generated":{"line":1,"column":1516}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":64,"column":16},"generated":{"line":1,"column":1519}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":64,"column":21},"generated":{"line":1,"column":1524}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":64,"column":29},"generated":{"line":1,"column":1532}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":64,"column":41},"generated":{"line":1,"column":1535}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":64,"column":46},"generated":{"line":1,"column":1537}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":65,"column":19},"generated":{"line":1,"column":1548}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":66,"column":16},"generated":{"line":1,"column":1549}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":66,"column":20},"generated":{"line":1,"column":1553}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":66,"column":40},"generated":{"line":1,"column":1555}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":66,"column":45},"generated":{"line":1,"column":1560}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":66,"column":57},"generated":{"line":1,"column":1572}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":66,"column":61},"generated":{"line":1,"column":1576}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":66,"column":66},"generated":{"line":1,"column":1581}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":66,"column":77},"generated":{"line":1,"column":1590}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":66,"column":83},"generated":{"line":1,"column":1594}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":66,"column":90},"generated":{"line":1,"column":1596}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":66,"column":96},"generated":{"line":1,"column":1600}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":67,"column":20},"generated":{"line":1,"column":1601}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":67,"column":34},"generated":{"line":1,"column":1614}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":68,"column":19},"generated":{"line":1,"column":1630}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":68,"column":24},"generated":{"line":1,"column":1635}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":68,"column":38},"generated":{"line":1,"column":1639}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":68,"column":43},"generated":{"line":1,"column":1644}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":68,"column":51},"generated":{"line":1,"column":1652}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":68,"column":63},"generated":{"line":1,"column":1655}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":68,"column":72},"generated":{"line":1,"column":1657}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":69,"column":16},"generated":{"line":1,"column":1664}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":69,"column":25},"generated":{"line":1,"column":1666}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":69,"column":30},"generated":{"line":1,"column":1671}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":72,"column":14},"generated":{"line":1,"column":1681}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":72,"column":22},"generated":{"line":1,"column":1689}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":72,"column":26},"generated":{"line":1,"column":1693}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":4,"column":0},"generated":{"line":1,"column":1699}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":4,"column":0},"generated":{"line":1,"column":1707}},{"source":"../../../src/gltfv2/loaders/BufferLoader.ts","name":null,"original":{"line":4,"column":0},"generated":{"line":1,"column":1720}}],"sources":{"../../../src/gltfv2/loaders/BufferLoader.ts":"import { IGLTF_v2 } from '@shapediver/viewer.data-engine.shared-types'\r\nimport { HttpClient } from '@shapediver/viewer.shared.services'\r\n\r\nexport class BufferLoader {\r\n    // #region Properties (2)\r\n\r\n    private readonly _httpClient: HttpClient = HttpClient.instance;\r\n\r\n    private _loaded: {\r\n        [key: string]: ArrayBuffer\r\n    } = {};\r\n\r\n    // #endregion Properties (2)\r\n\r\n    // #region Constructors (1)\r\n\r\n    constructor(private readonly _content: IGLTF_v2, private _body?: ArrayBuffer, private _baseUri?: string) { }\r\n\r\n    // #endregion Constructors (1)\r\n\r\n    // #region Public Methods (2)\r\n\r\n    public getBuffer(bufferId: number): ArrayBuffer {\r\n        if (!this._content.buffers) throw new Error('BufferLoader.getBuffer: Buffers not available.')\r\n        if (!this._content.buffers[bufferId]) throw new Error('BufferLoader.getBuffer: Buffer not available.')\r\n        if (!this._loaded[bufferId]) throw new Error('BufferLoader.getBuffer: Buffer not loaded.')\r\n        return this._loaded[bufferId];\r\n    }\r\n\r\n    public async load(): Promise<void> {\r\n        if (!this._content.buffers) return;\r\n\r\n        let promises: Promise<void>[] = [];\r\n\r\n        for (let i = 0; i < this._content.buffers.length; i++) {\r\n            const bufferId = i;\r\n            const buffer = this._content.buffers[bufferId];\r\n\r\n            if (buffer.type && buffer.type !== 'arraybuffer') {\r\n                throw new Error(`BufferLoader.load: ${buffer.type} is not supported.`);\r\n            }\r\n\r\n            // If present, GLB container is required to be the first buffer.\r\n            if (buffer.uri === undefined && bufferId === 0) {\r\n                if (!this._body) throw new Error(`BufferLoader.load: Buffer not available.`);\r\n                this._loaded[bufferId] = this._body;\r\n                return;\r\n            }\r\n\r\n            const dataUriRegex = /^data:(.*?)(;base64)?,(.*)$/;\r\n            const dataUriRegexResult = buffer.uri!.match(dataUriRegex);\r\n\r\n            // Safari can not handle Data URIs through XMLHttpRequest so process manually\r\n            if (dataUriRegexResult) {\r\n                const isBase64 = !!dataUriRegexResult[2];\r\n                let data = dataUriRegexResult[3];\r\n                data = decodeURIComponent(data);\r\n                if (isBase64) data = atob(data);\r\n\r\n                const view = new Uint8Array(data.length);\r\n                for (let i = 0; i < data.length; i++) {\r\n                    view[i] = data.charCodeAt(i);\r\n                }\r\n                this._loaded[bufferId] = view.buffer;\r\n            } else {\r\n                let httpResultPromise = this._httpClient.get(this._baseUri + '/' + buffer.uri!, {\r\n                    responseType: 'arraybuffer'\r\n                }).then(response => { this._loaded[bufferId] = response.data; });\r\n                promises.push(httpResultPromise)\r\n            }\r\n        }\r\n        await Promise.all(promises);\r\n    }\r\n\r\n    // #endregion Public Methods (2)\r\n}\r\n"},"lineCount":null}},"error":null,"hash":"41a5934f0a06d8a7621d5b7d99cd3bad","cacheData":{"env":{}}}