{"id":"node_modules/@shapediver/viewer.rendering-engine.camera-engine/dist/implementation/controls/orthographic/CameraControlsEventDistribution.js","dependencies":[{"name":"D:\\projects\\myProjects\\shapeApp\\node_modules\\@shapediver\\viewer.rendering-engine.camera-engine\\dist\\implementation\\controls\\orthographic\\CameraControlsEventDistribution.js.map","includedInParent":true,"mtime":1706527151594},{"name":"D:\\projects\\myProjects\\shapeApp\\node_modules\\@shapediver\\viewer.rendering-engine.camera-engine\\src\\implementation\\controls\\orthographic\\CameraControlsEventDistribution.ts","includedInParent":true,"mtime":1706527152791},{"name":"D:\\projects\\myProjects\\shapeApp\\package.json","includedInParent":true,"mtime":1706533774939},{"name":"D:\\projects\\myProjects\\shapeApp\\node_modules\\@shapediver\\viewer.rendering-engine.camera-engine\\package.json","includedInParent":true,"mtime":1706527151358}],"generated":{"js":"\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.CameraControlsEventDistribution = void 0;\r\nclass CameraControlsEventDistribution {\r\n    // #endregion Properties (2)\r\n    // #region Constructors (1)\r\n    constructor(_controls, _cameraLogic) {\r\n        this._controls = _controls;\r\n        this._cameraLogic = _cameraLogic;\r\n        // #region Properties (2)\r\n        this._active = {\r\n            zoom: false,\r\n            pan: false\r\n        };\r\n        this._activeEvents = true;\r\n    }\r\n    // #endregion Constructors (1)\r\n    // #region Public Methods (14)\r\n    activateCameraEvents() {\r\n        this._activeEvents = true;\r\n    }\r\n    deactivateCameraEvents() {\r\n        this._activeEvents = false;\r\n    }\r\n    onDown(event) {\r\n        if (this._controls.camera.active === false)\r\n            return;\r\n        let { x, y } = this.convertInput(event);\r\n        let input = window.TouchEvent && event instanceof TouchEvent ? event.touches.length : event.button;\r\n        let mapping = window.TouchEvent && event instanceof TouchEvent ? this._controls.input.touch : this._controls.input.mouse;\r\n        if (input === mapping.pan && this._controls.enablePan) {\r\n            this._cameraLogic.pan(x, y, this._active.pan, window.TouchEvent && event instanceof TouchEvent);\r\n            this._active.pan = true;\r\n            this._active.zoom = false;\r\n        }\r\n        if (input === mapping.zoom && this._controls.enableZoom) {\r\n            let x1 = x, y1 = y;\r\n            if (window.TouchEvent && event instanceof TouchEvent && this._controls.input.touch.zoom === 2) {\r\n                x1 = (event.touches[0].pageX - event.touches[1].pageX) / window.innerWidth * (window.innerWidth / window.innerHeight);\r\n                y1 = (event.touches[0].pageY - event.touches[1].pageY) / window.innerHeight;\r\n            }\r\n            this._cameraLogic.zoom(x1, y1, this._active.zoom, window.TouchEvent && event instanceof TouchEvent);\r\n            this._active.pan = false;\r\n            this._active.zoom = true;\r\n        }\r\n    }\r\n    onKey(event) {\r\n        if (this._controls.camera.active === false)\r\n            return;\r\n        if (this._controls.enableKeyPan) {\r\n            switch (event.keyCode) {\r\n                case this._controls.input.keys.up:\r\n                    this._cameraLogic.pan(0, 0, false, false);\r\n                    this._cameraLogic.pan(0, this._controls.keyPanSpeed * 0.05, true, false);\r\n                    event.preventDefault();\r\n                    event.stopPropagation();\r\n                    break;\r\n                case this._controls.input.keys.down:\r\n                    this._cameraLogic.pan(0, 0, false, false);\r\n                    this._cameraLogic.pan(0, -this._controls.keyPanSpeed * 0.05, true, false);\r\n                    event.preventDefault();\r\n                    event.stopPropagation();\r\n                    break;\r\n                case this._controls.input.keys.left:\r\n                    this._cameraLogic.pan(0, 0, false, false);\r\n                    this._cameraLogic.pan(this._controls.keyPanSpeed * 0.05, 0, true, false);\r\n                    event.preventDefault();\r\n                    event.stopPropagation();\r\n                    break;\r\n                case this._controls.input.keys.right:\r\n                    this._cameraLogic.pan(0, 0, false, false);\r\n                    this._cameraLogic.pan(-this._controls.keyPanSpeed * 0.05, 0, true, false);\r\n                    event.preventDefault();\r\n                    event.stopPropagation();\r\n                    break;\r\n            }\r\n        }\r\n    }\r\n    onKeyDown(event) {\r\n        if (this._controls.camera.active === false)\r\n            return;\r\n        if (!this._activeEvents)\r\n            return;\r\n        this.onKey(event);\r\n    }\r\n    onMouseDown(event) {\r\n        if (this._controls.camera.active === false)\r\n            return;\r\n        if (!this._activeEvents)\r\n            return;\r\n        this.onDown(event);\r\n    }\r\n    onMouseMove(event) {\r\n        if (this._controls.camera.active === false)\r\n            return;\r\n        if (!this._activeEvents)\r\n            return;\r\n        this.onMove(event);\r\n    }\r\n    onMouseEnd(event) {\r\n        if (this._controls.camera.active === false)\r\n            return;\r\n        if (!this._activeEvents)\r\n            return;\r\n        this.onUp(event);\r\n    }\r\n    onMouseUp(event) {\r\n        if (this._controls.camera.active === false)\r\n            return;\r\n    }\r\n    onMouseOut(event) {\r\n        if (this._controls.camera.active === false)\r\n            return;\r\n    }\r\n    onMouseWheel(event) {\r\n        if (this._controls.camera.active === false)\r\n            return;\r\n        if (!this._activeEvents)\r\n            return;\r\n        this.onWheel(event);\r\n    }\r\n    onMove(event) {\r\n        if (this._controls.camera.active === false)\r\n            return;\r\n        let { x, y } = this.convertInput(event);\r\n        if (this._controls.enablePan && this._active.pan)\r\n            this._cameraLogic.pan(x, y, this._active.pan, window.TouchEvent && event instanceof TouchEvent);\r\n        if (this._controls.enableZoom && this._active.zoom) {\r\n            let x1 = x, y1 = y;\r\n            if (window.TouchEvent && event instanceof TouchEvent && this._controls.input.touch.zoom === 2) {\r\n                x1 = (event.touches[0].pageX - event.touches[1].pageX) / window.innerWidth * (window.innerWidth / window.innerHeight);\r\n                y1 = (event.touches[0].pageY - event.touches[1].pageY) / window.innerHeight;\r\n            }\r\n            this._cameraLogic.zoom(x1, y1, this._active.zoom, window.TouchEvent && event instanceof TouchEvent);\r\n        }\r\n    }\r\n    onTouchEnd(event) {\r\n        if (this._controls.camera.active === false)\r\n            return;\r\n        if (!this._activeEvents)\r\n            return;\r\n        this.onUp(event);\r\n    }\r\n    onTouchMove(event) {\r\n        if (this._controls.camera.active === false)\r\n            return;\r\n        if (!this._activeEvents)\r\n            return;\r\n        this.onMove(event);\r\n    }\r\n    onTouchStart(event) {\r\n        if (this._controls.camera.active === false)\r\n            return;\r\n        if (!this._activeEvents)\r\n            return;\r\n        this.onDown(event);\r\n    }\r\n    onTouchCancel(event) {\r\n        if (this._controls.camera.active === false)\r\n            return;\r\n    }\r\n    onTouchUp(event) {\r\n        if (this._controls.camera.active === false)\r\n            return;\r\n    }\r\n    onUp(event) {\r\n        if (this._controls.camera.active === false)\r\n            return;\r\n        this._active.zoom = false;\r\n        this._active.pan = false;\r\n    }\r\n    onWheel(event) {\r\n        if (this._controls.camera.active === false)\r\n            return;\r\n        if (!this._controls.enableZoom)\r\n            return;\r\n        let delta = 0;\r\n        if (event.deltaY !== undefined) {\r\n            // WebKit / Opera / Explorer 9\r\n            delta = -event.deltaY;\r\n        }\r\n        else if (event.detail !== undefined) {\r\n            // Firefox\r\n            delta = -event.detail;\r\n        }\r\n        if (Math.sign(delta) > 0) {\r\n            this._cameraLogic.zoom(0, 0, false, false);\r\n            this._cameraLogic.zoom(1.0, 0, true, false);\r\n        }\r\n        else {\r\n            this._cameraLogic.zoom(1.0, 0, false, false);\r\n            this._cameraLogic.zoom(0, 0, true, false);\r\n        }\r\n    }\r\n    reset() {\r\n        this._active = {\r\n            zoom: false,\r\n            pan: false\r\n        };\r\n    }\r\n    // #endregion Public Methods (14)\r\n    // #region Private Methods (1)\r\n    convertInput(event) {\r\n        let aspect = window.innerWidth / window.innerHeight;\r\n        if (event instanceof MouseEvent) {\r\n            return {\r\n                x: event.clientX / window.innerWidth * aspect,\r\n                y: event.clientY / window.innerHeight\r\n            };\r\n        }\r\n        else {\r\n            return {\r\n                x: event.touches[0].pageX / window.innerWidth * aspect,\r\n                y: event.touches[0].pageY / window.innerHeight\r\n            };\r\n        }\r\n    }\r\n}\r\nexports.CameraControlsEventDistribution = CameraControlsEventDistribution;\r\n"},"sourceMaps":{"js":{"version":3,"file":"CameraControlsEventDistribution.js","sourceRoot":"","sources":["../../../../src/implementation/controls/orthographic/CameraControlsEventDistribution.ts"],"names":[],"mappings":"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","sourcesContent":["import { CameraControlsLogic } from './CameraControlsLogic'\r\nimport { ICameraControlsEventDistribution } from '../../../interfaces/controls/ICameraControlsEventDistribution'\r\nimport { OrthographicCameraControls } from '../OrthographicCameraControls'\r\n\r\nexport class CameraControlsEventDistribution implements ICameraControlsEventDistribution {\r\n    // #region Properties (2)\r\n\r\n    private _active = {\r\n        zoom: false,\r\n        pan: false\r\n    };\r\n\r\n    private _activeEvents = true;\r\n\r\n    // #endregion Properties (2)\r\n\r\n    // #region Constructors (1)\r\n\r\n    constructor(private readonly _controls: OrthographicCameraControls, private readonly _cameraLogic: CameraControlsLogic) { }\r\n\r\n    // #endregion Constructors (1)\r\n\r\n    // #region Public Methods (14)\r\n        \r\n    public activateCameraEvents(): void {\r\n        this._activeEvents = true;\r\n    }\r\n\r\n    public deactivateCameraEvents(): void {\r\n        this._activeEvents = false;\r\n    }\r\n\r\n    public onDown(event: MouseEvent | TouchEvent): void {\r\n        if(this._controls.camera.active === false) return;\r\n        let { x, y } = this.convertInput(event);\r\n\r\n        let input = window.TouchEvent && event instanceof TouchEvent ? (event as TouchEvent).touches.length : (event as MouseEvent).button;\r\n        let mapping = window.TouchEvent && event instanceof TouchEvent ? this._controls.input.touch : this._controls.input.mouse;\r\n\r\n        if (input === mapping.pan && this._controls.enablePan) {\r\n            this._cameraLogic.pan(x, y, this._active.pan, window.TouchEvent && event instanceof TouchEvent);\r\n            this._active.pan = true;\r\n            this._active.zoom = false;\r\n        }\r\n\r\n        if (input === mapping.zoom && this._controls.enableZoom) {\r\n            let x1 = x, y1 = y;\r\n            if (window.TouchEvent && event instanceof TouchEvent && this._controls.input.touch.zoom === 2) {\r\n                x1 = (event.touches[0].pageX - event.touches[1].pageX) / window.innerWidth * (window.innerWidth / window.innerHeight);\r\n                y1 = (event.touches[0].pageY - event.touches[1].pageY) / window.innerHeight;\r\n            }\r\n            this._cameraLogic.zoom(x1, y1, this._active.zoom, window.TouchEvent && event instanceof TouchEvent);\r\n            this._active.pan = false;\r\n            this._active.zoom = true;\r\n        }\r\n    }\r\n\r\n    public onKey(event: KeyboardEvent): void {\r\n        if(this._controls.camera.active === false) return;\r\n        if (this._controls.enableKeyPan) {\r\n            switch (event.keyCode) {\r\n                case this._controls.input.keys.up:\r\n                    this._cameraLogic.pan(0, 0, false, false);\r\n                    this._cameraLogic.pan(0, this._controls.keyPanSpeed * 0.05, true, false);\r\n                    event.preventDefault();\r\n                    event.stopPropagation();\r\n                    break;\r\n\r\n                case this._controls.input.keys.down:\r\n                    this._cameraLogic.pan(0, 0, false, false);\r\n                    this._cameraLogic.pan(0, -this._controls.keyPanSpeed * 0.05, true, false);\r\n                    event.preventDefault();\r\n                    event.stopPropagation();\r\n                    break;\r\n\r\n                case this._controls.input.keys.left:\r\n                    this._cameraLogic.pan(0, 0, false, false);\r\n                    this._cameraLogic.pan(this._controls.keyPanSpeed * 0.05, 0, true, false);\r\n                    event.preventDefault();\r\n                    event.stopPropagation();\r\n                    break;\r\n\r\n                case this._controls.input.keys.right:\r\n                    this._cameraLogic.pan(0, 0, false, false);\r\n                    this._cameraLogic.pan(-this._controls.keyPanSpeed * 0.05, 0, true, false);\r\n                    event.preventDefault();\r\n                    event.stopPropagation();\r\n                    break;\r\n            }\r\n        }\r\n    }\r\n\r\n    public onKeyDown(event: KeyboardEvent): void {\r\n        if(this._controls.camera.active === false) return;\r\n        if(!this._activeEvents) return;\r\n        this.onKey(event)\r\n    }\r\n\r\n    public onMouseDown(event: MouseEvent): void {\r\n        if(this._controls.camera.active === false) return;\r\n        if(!this._activeEvents) return;\r\n        this.onDown(event);\r\n    }\r\n\r\n    public onMouseMove(event: MouseEvent): void {\r\n        if(this._controls.camera.active === false) return;\r\n        if(!this._activeEvents) return;\r\n        this.onMove(event);\r\n    }\r\n\r\n    public onMouseEnd(event: MouseEvent): void {\r\n        if(this._controls.camera.active === false) return;\r\n        if(!this._activeEvents) return;\r\n        this.onUp(event);\r\n    }\r\n    \r\n    public onMouseUp(event: WheelEvent): void {\r\n        if(this._controls.camera.active === false) return;\r\n    }\r\n\r\n    public onMouseOut(event: WheelEvent): void {\r\n        if(this._controls.camera.active === false) return;\r\n    }\r\n\r\n    public onMouseWheel(event: WheelEvent): void {\r\n        if(this._controls.camera.active === false) return;\r\n        if(!this._activeEvents) return;\r\n        this.onWheel(event);\r\n    }\r\n\r\n    public onMove(event: MouseEvent | TouchEvent): void {\r\n        if(this._controls.camera.active === false) return;\r\n        let { x, y } = this.convertInput(event);\r\n\r\n        if (this._controls.enablePan && this._active.pan)\r\n            this._cameraLogic.pan(x, y, this._active.pan, window.TouchEvent && event instanceof TouchEvent);\r\n\r\n        if (this._controls.enableZoom && this._active.zoom) {\r\n            let x1 = x, y1 = y;\r\n            if (window.TouchEvent && event instanceof TouchEvent && this._controls.input.touch.zoom === 2) {\r\n                x1 = (event.touches[0].pageX - event.touches[1].pageX) / window.innerWidth * (window.innerWidth / window.innerHeight);\r\n                y1 = (event.touches[0].pageY - event.touches[1].pageY) / window.innerHeight;\r\n            }\r\n            this._cameraLogic.zoom(x1, y1, this._active.zoom, window.TouchEvent && event instanceof TouchEvent);\r\n        }\r\n    }\r\n\r\n    public onTouchEnd(event: TouchEvent): void {\r\n        if(this._controls.camera.active === false) return;\r\n        if(!this._activeEvents) return;\r\n        this.onUp(event);\r\n    }\r\n\r\n    public onTouchMove(event: TouchEvent): void {\r\n        if(this._controls.camera.active === false) return;\r\n        if(!this._activeEvents) return;\r\n        this.onMove(event);\r\n    }\r\n\r\n    public onTouchStart(event: TouchEvent): void {\r\n        if(this._controls.camera.active === false) return;\r\n        if(!this._activeEvents) return;\r\n        this.onDown(event);\r\n    }\r\n\r\n    public onTouchCancel(event: TouchEvent): void {\r\n        if(this._controls.camera.active === false) return;\r\n    }\r\n\r\n    public onTouchUp(event: TouchEvent): void {\r\n        if(this._controls.camera.active === false) return;\r\n    }\r\n\r\n    public onUp(event: MouseEvent | TouchEvent): void {\r\n        if(this._controls.camera.active === false) return;\r\n        this._active.zoom = false;\r\n        this._active.pan = false;\r\n    }\r\n\r\n    public onWheel(event: WheelEvent): void {\r\n        if(this._controls.camera.active === false) return;\r\n        if (!this._controls.enableZoom) return;\r\n        let delta = 0;\r\n        if (event.deltaY !== undefined) {\r\n            // WebKit / Opera / Explorer 9\r\n            delta = -event.deltaY;\r\n        } else if (event.detail !== undefined) {\r\n            // Firefox\r\n            delta = -event.detail;\r\n        }\r\n\r\n        if (Math.sign(delta) > 0) {\r\n            this._cameraLogic.zoom(0, 0, false, false);\r\n            this._cameraLogic.zoom(1.0, 0, true, false);\r\n        } else {\r\n            this._cameraLogic.zoom(1.0, 0, false, false);\r\n            this._cameraLogic.zoom(0, 0, true, false);\r\n        }\r\n    }\r\n\r\n    public reset() {\r\n        this._active = {\r\n            zoom: false,\r\n            pan: false\r\n        };\r\n    }\r\n\r\n    // #endregion Public Methods (14)\r\n\r\n    // #region Private Methods (1)\r\n\r\n    private convertInput(event: MouseEvent | TouchEvent): { x: number, y: number } {\r\n        let aspect = window.innerWidth / window.innerHeight;\r\n        if (event instanceof MouseEvent) {\r\n            return {\r\n                x: event.clientX / window.innerWidth * aspect,\r\n                y: event.clientY / window.innerHeight\r\n            }\r\n        } else {\r\n            return {\r\n                x: event.touches[0].pageX / window.innerWidth * aspect,\r\n                y: event.touches[0].pageY / window.innerHeight\r\n            }\r\n        }\r\n    }\r\n\r\n    // #endregion Private Methods (1)\r\n}\r\n"]}},"error":null,"hash":"83080b439410e34a2049adf7e4e10667","cacheData":{"env":{}}}