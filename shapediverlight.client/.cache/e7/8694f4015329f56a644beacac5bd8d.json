{"id":"node_modules/@shapediver/viewer.session-engine.session-engine/dist/implementation/dto/Export.js","dependencies":[{"name":"F:\\UpworkProjects\\ShapeDiverLight\\ShapeDiverLight\\shapediverlight.client\\node_modules\\@shapediver\\viewer.session-engine.session-engine\\dist\\implementation\\dto\\Export.js.map","includedInParent":true,"mtime":1706542085856},{"name":"F:\\UpworkProjects\\ShapeDiverLight\\ShapeDiverLight\\shapediverlight.client\\node_modules\\@shapediver\\viewer.session-engine.session-engine\\src\\implementation\\dto\\Export.ts","includedInParent":true,"mtime":1706542086579},{"name":"F:\\UpworkProjects\\ShapeDiverLight\\ShapeDiverLight\\shapediverlight.client\\package.json","includedInParent":true,"mtime":1706542184022},{"name":"F:\\UpworkProjects\\ShapeDiverLight\\ShapeDiverLight\\shapediverlight.client\\node_modules\\@shapediver\\viewer.session-engine.session-engine\\package.json","includedInParent":true,"mtime":1706542085742},{"name":"@shapediver/viewer.shared.services","loc":{"line":25,"column":41,"index":2364},"parent":"F:\\UpworkProjects\\ShapeDiverLight\\ShapeDiverLight\\shapediverlight.client\\node_modules\\@shapediver\\viewer.session-engine.session-engine\\dist\\implementation\\dto\\Export.js","resolved":"F:\\UpworkProjects\\ShapeDiverLight\\ShapeDiverLight\\shapediverlight.client\\node_modules\\@shapediver\\viewer.shared.services\\dist\\index.js"},{"name":"@shapediver/viewer.shared.types","loc":{"line":26,"column":38,"index":2442},"parent":"F:\\UpworkProjects\\ShapeDiverLight\\ShapeDiverLight\\shapediverlight.client\\node_modules\\@shapediver\\viewer.session-engine.session-engine\\dist\\implementation\\dto\\Export.js","resolved":"F:\\UpworkProjects\\ShapeDiverLight\\ShapeDiverLight\\shapediverlight.client\\node_modules\\@shapediver\\viewer.shared.types\\dist\\index.js"}],"generated":{"js":"\"use strict\";\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __classPrivateFieldSet = (this && this.__classPrivateFieldSet) || function (receiver, state, value, kind, f) {\r\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\r\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\r\n};\r\nvar __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\r\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\r\n};\r\nvar _Export_eventEngine, _Export_id, _Export_inputValidator, _Export_logger, _Export_name, _Export_sessionEngine, _Export_type, _Export_uuidGenerator, _Export_content, _Export_delay, _Export_dependency, _Export_displayname, _Export_filename, _Export_group, _Export_hidden, _Export_maxWaitTime, _Export_msg, _Export_order, _Export_result, _Export_status_collect, _Export_status_computation, _Export_tooltip, _Export_uid, _Export_version;\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.Export = void 0;\r\nconst viewer_shared_services_1 = require(\"@shapediver/viewer.shared.services\");\r\nconst viewer_shared_types_1 = require(\"@shapediver/viewer.shared.types\");\r\nclass Export {\r\n    // #endregion Properties (24)\r\n    // #region Constructors (1)\r\n    constructor(exportDef, sessionEngine) {\r\n        // #region Properties (24)\r\n        _Export_eventEngine.set(this, viewer_shared_services_1.EventEngine.instance);\r\n        _Export_id.set(this, void 0);\r\n        _Export_inputValidator.set(this, viewer_shared_services_1.InputValidator.instance);\r\n        _Export_logger.set(this, viewer_shared_services_1.Logger.instance);\r\n        _Export_name.set(this, void 0);\r\n        _Export_sessionEngine.set(this, void 0);\r\n        _Export_type.set(this, void 0);\r\n        _Export_uuidGenerator.set(this, viewer_shared_services_1.UuidGenerator.instance);\r\n        _Export_content.set(this, void 0);\r\n        _Export_delay.set(this, void 0);\r\n        _Export_dependency.set(this, void 0);\r\n        _Export_displayname.set(this, void 0);\r\n        _Export_filename.set(this, void 0);\r\n        _Export_group.set(this, void 0);\r\n        _Export_hidden.set(this, false);\r\n        _Export_maxWaitTime.set(this, 300000);\r\n        _Export_msg.set(this, void 0);\r\n        _Export_order.set(this, void 0);\r\n        _Export_result.set(this, void 0);\r\n        _Export_status_collect.set(this, void 0);\r\n        _Export_status_computation.set(this, void 0);\r\n        _Export_tooltip.set(this, void 0);\r\n        _Export_uid.set(this, void 0);\r\n        _Export_version.set(this, void 0);\r\n        __classPrivateFieldSet(this, _Export_sessionEngine, sessionEngine, \"f\");\r\n        __classPrivateFieldSet(this, _Export_id, exportDef.id, \"f\");\r\n        __classPrivateFieldSet(this, _Export_name, exportDef.name, \"f\");\r\n        __classPrivateFieldSet(this, _Export_type, exportDef.type, \"f\");\r\n        this.updateExportDefinition(exportDef);\r\n    }\r\n    // #endregion Constructors (1)\r\n    // #region Public Accessors (24)\r\n    get content() {\r\n        return __classPrivateFieldGet(this, _Export_content, \"f\");\r\n    }\r\n    get delay() {\r\n        return __classPrivateFieldGet(this, _Export_delay, \"f\");\r\n    }\r\n    get dependency() {\r\n        return __classPrivateFieldGet(this, _Export_dependency, \"f\");\r\n    }\r\n    get displayname() {\r\n        return __classPrivateFieldGet(this, _Export_displayname, \"f\");\r\n    }\r\n    set displayname(value) {\r\n        __classPrivateFieldSet(this, _Export_displayname, value, \"f\");\r\n    }\r\n    get filename() {\r\n        return __classPrivateFieldGet(this, _Export_filename, \"f\");\r\n    }\r\n    get group() {\r\n        return __classPrivateFieldGet(this, _Export_group, \"f\");\r\n    }\r\n    get hidden() {\r\n        return __classPrivateFieldGet(this, _Export_hidden, \"f\");\r\n    }\r\n    set hidden(value) {\r\n        __classPrivateFieldSet(this, _Export_hidden, value, \"f\");\r\n    }\r\n    get id() {\r\n        return __classPrivateFieldGet(this, _Export_id, \"f\");\r\n    }\r\n    get maxWaitTime() {\r\n        return __classPrivateFieldGet(this, _Export_maxWaitTime, \"f\");\r\n    }\r\n    set maxWaitTime(value) {\r\n        __classPrivateFieldSet(this, _Export_maxWaitTime, value, \"f\");\r\n    }\r\n    get msg() {\r\n        return __classPrivateFieldGet(this, _Export_msg, \"f\");\r\n    }\r\n    get name() {\r\n        return __classPrivateFieldGet(this, _Export_name, \"f\");\r\n    }\r\n    get order() {\r\n        return __classPrivateFieldGet(this, _Export_order, \"f\");\r\n    }\r\n    set order(value) {\r\n        __classPrivateFieldSet(this, _Export_order, value, \"f\");\r\n    }\r\n    get result() {\r\n        return __classPrivateFieldGet(this, _Export_result, \"f\");\r\n    }\r\n    get status_collect() {\r\n        return __classPrivateFieldGet(this, _Export_status_collect, \"f\");\r\n    }\r\n    get status_computation() {\r\n        return __classPrivateFieldGet(this, _Export_status_computation, \"f\");\r\n    }\r\n    get tooltip() {\r\n        return __classPrivateFieldGet(this, _Export_tooltip, \"f\");\r\n    }\r\n    set tooltip(value) {\r\n        __classPrivateFieldSet(this, _Export_tooltip, value, \"f\");\r\n    }\r\n    get type() {\r\n        return __classPrivateFieldGet(this, _Export_type, \"f\");\r\n    }\r\n    get uid() {\r\n        return __classPrivateFieldGet(this, _Export_uid, \"f\");\r\n    }\r\n    get version() {\r\n        return __classPrivateFieldGet(this, _Export_version, \"f\");\r\n    }\r\n    // #endregion Public Accessors (24)\r\n    // #region Public Methods (3)\r\n    request(parameters = {}) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            const eventId = __classPrivateFieldGet(this, _Export_uuidGenerator, \"f\").create();\r\n            try {\r\n                const event = { type: viewer_shared_types_1.TASK_TYPE.EXPORT_REQUEST, id: eventId, progress: 0, status: 'Requesting export' };\r\n                __classPrivateFieldGet(this, _Export_eventEngine, \"f\").emitEvent(viewer_shared_services_1.EVENTTYPE.TASK.TASK_START, event);\r\n                __classPrivateFieldGet(this, _Export_logger, \"f\").debugLow(`Export(${__classPrivateFieldGet(this, _Export_id, \"f\")}).request: Sending export request.`);\r\n                const currentParameters = __classPrivateFieldGet(this, _Export_sessionEngine, \"f\").parameterValues;\r\n                const exportParameters = {};\r\n                for (let parameter in currentParameters)\r\n                    exportParameters[parameter] = parameters[parameter] || parameters[parameter] === '' ? parameters[parameter] : currentParameters[parameter];\r\n                __classPrivateFieldGet(this, _Export_logger, \"f\").info(`Export(${__classPrivateFieldGet(this, _Export_id, \"f\")}).request: Sending export request with parameters ${JSON.stringify(exportParameters)}.`);\r\n                const exportDef = yield __classPrivateFieldGet(this, _Export_sessionEngine, \"f\").requestExport(this.id, exportParameters, __classPrivateFieldGet(this, _Export_maxWaitTime, \"f\"));\r\n                this.updateExportDefinition(exportDef);\r\n                const eventEnd = { type: viewer_shared_types_1.TASK_TYPE.EXPORT_REQUEST, id: eventId, progress: 1, status: 'Returning export' };\r\n                __classPrivateFieldGet(this, _Export_eventEngine, \"f\").emitEvent(viewer_shared_services_1.EVENTTYPE.TASK.TASK_END, eventEnd);\r\n                return exportDef;\r\n            }\r\n            catch (e) {\r\n                const eventEnd = { type: viewer_shared_types_1.TASK_TYPE.EXPORT_REQUEST, id: eventId, progress: 1, status: 'Export request failed' };\r\n                __classPrivateFieldGet(this, _Export_eventEngine, \"f\").emitEvent(viewer_shared_services_1.EVENTTYPE.TASK.TASK_CANCEL, eventEnd);\r\n                throw e;\r\n            }\r\n        });\r\n    }\r\n    updateExport() {\r\n        const exportDef = __classPrivateFieldGet(this, _Export_sessionEngine, \"f\").exports[this.id];\r\n        __classPrivateFieldSet(this, _Export_dependency, exportDef.dependency, \"f\");\r\n        __classPrivateFieldSet(this, _Export_uid, exportDef.uid, \"f\");\r\n        __classPrivateFieldSet(this, _Export_displayname, exportDef.displayname, \"f\");\r\n        __classPrivateFieldSet(this, _Export_order, exportDef.order, \"f\");\r\n        __classPrivateFieldSet(this, _Export_hidden, exportDef.hidden, \"f\");\r\n        __classPrivateFieldSet(this, _Export_tooltip, exportDef.tooltip, \"f\");\r\n        __classPrivateFieldSet(this, _Export_version, exportDef.version, \"f\");\r\n        __classPrivateFieldSet(this, _Export_delay, exportDef.delay, \"f\");\r\n        __classPrivateFieldSet(this, _Export_content, exportDef.content, \"f\");\r\n        __classPrivateFieldSet(this, _Export_msg, exportDef.msg, \"f\");\r\n        __classPrivateFieldSet(this, _Export_filename, exportDef.filename, \"f\");\r\n        __classPrivateFieldSet(this, _Export_result, exportDef.result, \"f\");\r\n        __classPrivateFieldSet(this, _Export_status_computation, exportDef.status_computation, \"f\");\r\n        __classPrivateFieldSet(this, _Export_status_collect, exportDef.status_collect, \"f\");\r\n        __classPrivateFieldSet(this, _Export_group, exportDef.group, \"f\");\r\n    }\r\n    updateExportDefinition(exportDef) {\r\n        __classPrivateFieldSet(this, _Export_dependency, exportDef.dependency, \"f\");\r\n        __classPrivateFieldSet(this, _Export_uid, exportDef.uid, \"f\");\r\n        __classPrivateFieldSet(this, _Export_displayname, exportDef.displayname, \"f\");\r\n        __classPrivateFieldSet(this, _Export_order, exportDef.order, \"f\");\r\n        __classPrivateFieldSet(this, _Export_hidden, exportDef.hidden, \"f\");\r\n        __classPrivateFieldSet(this, _Export_tooltip, exportDef.tooltip, \"f\");\r\n        __classPrivateFieldSet(this, _Export_version, exportDef.version, \"f\");\r\n        __classPrivateFieldSet(this, _Export_delay, exportDef.delay, \"f\");\r\n        __classPrivateFieldSet(this, _Export_content, exportDef.content, \"f\");\r\n        __classPrivateFieldSet(this, _Export_msg, exportDef.msg, \"f\");\r\n        __classPrivateFieldSet(this, _Export_filename, exportDef.filename, \"f\");\r\n        __classPrivateFieldSet(this, _Export_result, exportDef.result, \"f\");\r\n        __classPrivateFieldSet(this, _Export_status_computation, exportDef.status_computation, \"f\");\r\n        __classPrivateFieldSet(this, _Export_status_collect, exportDef.status_collect, \"f\");\r\n        __classPrivateFieldSet(this, _Export_group, exportDef.group, \"f\");\r\n    }\r\n}\r\nexports.Export = Export;\r\n_Export_eventEngine = new WeakMap(), _Export_id = new WeakMap(), _Export_inputValidator = new WeakMap(), _Export_logger = new WeakMap(), _Export_name = new WeakMap(), _Export_sessionEngine = new WeakMap(), _Export_type = new WeakMap(), _Export_uuidGenerator = new WeakMap(), _Export_content = new WeakMap(), _Export_delay = new WeakMap(), _Export_dependency = new WeakMap(), _Export_displayname = new WeakMap(), _Export_filename = new WeakMap(), _Export_group = new WeakMap(), _Export_hidden = new WeakMap(), _Export_maxWaitTime = new WeakMap(), _Export_msg = new WeakMap(), _Export_order = new WeakMap(), _Export_result = new WeakMap(), _Export_status_collect = new WeakMap(), _Export_status_computation = new WeakMap(), _Export_tooltip = new WeakMap(), _Export_uid = new WeakMap(), _Export_version = new WeakMap();\r\n"},"sourceMaps":{"js":{"version":3,"file":"Export.js","sourceRoot":"","sources":["../../../src/implementation/dto/Export.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;AACA,+EAAmH;AACnH,yEAAwE;AAIxE,MAAa,MAAM;IA6BjB,6BAA6B;IAE7B,2BAA2B;IAE3B,YAAY,SAAmC,EAAE,aAA4B;QAhC7E,0BAA0B;QAE1B,8BAAqC,oCAAW,CAAC,QAAQ,EAAC;QAC1D,6BAAqB;QACrB,iCAA2C,uCAAc,CAAC,QAAQ,EAAC;QACnE,yBAA2B,+BAAM,CAAC,QAAQ,EAAC;QAC3C,+BAAuB;QACvB,wCAAuC;QACvC,+BAAuD;QACvD,gCAAyC,sCAAa,CAAC,QAAQ,EAAC;QAEhE,kCAA6C;QAC7C,gCAAgB;QAChB,qCAAuB;QACvB,sCAAsB;QACtB,mCAAmB;QACnB,gCAA0C;QAC1C,yBAAmB,KAAK,EAAC;QACzB,8BAAuB,MAAM,EAAC;QAC9B,8BAAa;QACb,gCAAgB;QAChB,iCAAwC;QACxC,yCAA2D;QAC3D,6CAA+D;QAC/D,kCAAkB;QAClB,8BAAc;QACd,kCAAkB;QAOhB,uBAAA,IAAI,yBAAkB,aAAa,MAAA,CAAC;QACpC,uBAAA,IAAI,cAAO,SAAS,CAAC,EAAE,MAAA,CAAC;QACxB,uBAAA,IAAI,gBAAS,SAAS,CAAC,IAAI,MAAA,CAAC;QAC5B,uBAAA,IAAI,gBAAS,SAAS,CAAC,IAAI,MAAA,CAAC;QAE5B,IAAI,CAAC,sBAAsB,CAAC,SAAS,CAAC,CAAC;IACzC,CAAC;IAED,8BAA8B;IAE9B,gCAAgC;IAEhC,IAAW,OAAO;QAChB,OAAO,uBAAA,IAAI,uBAAS,CAAC;IACvB,CAAC;IAED,IAAW,KAAK;QACd,OAAO,uBAAA,IAAI,qBAAO,CAAC;IACrB,CAAC;IAED,IAAW,UAAU;QACnB,OAAO,uBAAA,IAAI,0BAAY,CAAC;IAC1B,CAAC;IAED,IAAW,WAAW;QACpB,OAAO,uBAAA,IAAI,2BAAa,CAAC;IAC3B,CAAC;IAED,IAAW,WAAW,CAAC,KAAyB;QAC9C,uBAAA,IAAI,uBAAgB,KAAK,MAAA,CAAC;IAC5B,CAAC;IAED,IAAW,QAAQ;QACjB,OAAO,uBAAA,IAAI,wBAAU,CAAC;IACxB,CAAC;IAED,IAAW,KAAK;QACd,OAAO,uBAAA,IAAI,qBAAO,CAAC;IACrB,CAAC;IAED,IAAW,MAAM;QACf,OAAO,uBAAA,IAAI,sBAAQ,CAAC;IACtB,CAAC;IAED,IAAW,MAAM,CAAC,KAAc;QAC9B,uBAAA,IAAI,kBAAW,KAAK,MAAA,CAAC;IACvB,CAAC;IAED,IAAW,EAAE;QACX,OAAO,uBAAA,IAAI,kBAAI,CAAC;IAClB,CAAC;IAED,IAAW,WAAW;QACpB,OAAO,uBAAA,IAAI,2BAAa,CAAC;IAC3B,CAAC;IAED,IAAW,WAAW,CAAC,KAAa;QAClC,uBAAA,IAAI,uBAAgB,KAAK,MAAA,CAAC;IAC5B,CAAC;IAED,IAAW,GAAG;QACZ,OAAO,uBAAA,IAAI,mBAAK,CAAC;IACnB,CAAC;IAED,IAAW,IAAI;QACb,OAAO,uBAAA,IAAI,oBAAM,CAAC;IACpB,CAAC;IAED,IAAW,KAAK;QACd,OAAO,uBAAA,IAAI,qBAAO,CAAC;IACrB,CAAC;IAED,IAAW,KAAK,CAAC,KAAyB;QACxC,uBAAA,IAAI,iBAAU,KAAK,MAAA,CAAC;IACtB,CAAC;IAED,IAAW,MAAM;QACf,OAAO,uBAAA,IAAI,sBAAQ,CAAC;IACtB,CAAC;IAED,IAAW,cAAc;QACvB,OAAO,uBAAA,IAAI,8BAAgB,CAAC;IAC9B,CAAC;IAED,IAAW,kBAAkB;QAC3B,OAAO,uBAAA,IAAI,kCAAoB,CAAC;IAClC,CAAC;IAED,IAAW,OAAO;QAChB,OAAO,uBAAA,IAAI,uBAAS,CAAC;IACvB,CAAC;IAED,IAAW,OAAO,CAAC,KAAyB;QAC1C,uBAAA,IAAI,mBAAY,KAAK,MAAA,CAAC;IACxB,CAAC;IAED,IAAW,IAAI;QACb,OAAO,uBAAA,IAAI,oBAAM,CAAC;IACpB,CAAC;IAED,IAAW,GAAG;QACZ,OAAO,uBAAA,IAAI,mBAAK,CAAC;IACnB,CAAC;IAED,IAAW,OAAO;QAChB,OAAO,uBAAA,IAAI,uBAAS,CAAC;IACvB,CAAC;IAED,mCAAmC;IAEnC,6BAA6B;IAEhB,OAAO,CAAC,aAAwC,EAAE;;YAC7D,MAAM,OAAO,GAAG,uBAAA,IAAI,6BAAe,CAAC,MAAM,EAAE,CAAC;YAC7C,IAAI;gBACF,MAAM,KAAK,GAAe,EAAE,IAAI,EAAE,+BAAS,CAAC,cAAc,EAAE,EAAE,EAAE,OAAO,EAAE,QAAQ,EAAE,CAAC,EAAE,MAAM,EAAE,mBAAmB,EAAE,CAAC;gBACpH,uBAAA,IAAI,2BAAa,CAAC,SAAS,CAAC,kCAAS,CAAC,IAAI,CAAC,UAAU,EAAE,KAAK,CAAC,CAAC;gBAE9D,uBAAA,IAAI,sBAAQ,CAAC,QAAQ,CAAC,UAAU,uBAAA,IAAI,kBAAI,oCAAoC,CAAC,CAAC;gBAC9E,MAAM,iBAAiB,GAAG,uBAAA,IAAI,6BAAe,CAAC,eAAe,CAAC;gBAC9D,MAAM,gBAAgB,GAA8B,EAAE,CAAA;gBAEtD,KAAK,IAAI,SAAS,IAAI,iBAAiB;oBACrC,gBAAgB,CAAC,SAAS,CAAC,GAAG,UAAU,CAAC,SAAS,CAAC,IAAI,UAAU,CAAC,SAAS,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC,UAAU,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,iBAAiB,CAAC,SAAS,CAAC,CAAC;gBAE7I,uBAAA,IAAI,sBAAQ,CAAC,IAAI,CAAC,UAAU,uBAAA,IAAI,kBAAI,qDAAqD,IAAI,CAAC,SAAS,CAAC,gBAAgB,CAAC,GAAG,CAAC,CAAC;gBAE9H,MAAM,SAAS,GAAG,MAAM,uBAAA,IAAI,6BAAe,CAAC,aAAa,CAAC,IAAI,CAAC,EAAE,EAAE,gBAAgB,EAAE,uBAAA,IAAI,2BAAa,CAAC,CAAC;gBACxG,IAAI,CAAC,sBAAsB,CAAC,SAAS,CAAC,CAAC;gBAEvC,MAAM,QAAQ,GAAe,EAAE,IAAI,EAAE,+BAAS,CAAC,cAAc,EAAE,EAAE,EAAE,OAAO,EAAE,QAAQ,EAAE,CAAC,EAAE,MAAM,EAAE,kBAAkB,EAAE,CAAC;gBACtH,uBAAA,IAAI,2BAAa,CAAC,SAAS,CAAC,kCAAS,CAAC,IAAI,CAAC,QAAQ,EAAE,QAAQ,CAAC,CAAC;gBAE/D,OAAO,SAAS,CAAC;aAClB;YAAC,OAAO,CAAC,EAAE;gBACV,MAAM,QAAQ,GAAe,EAAE,IAAI,EAAE,+BAAS,CAAC,cAAc,EAAE,EAAE,EAAE,OAAO,EAAE,QAAQ,EAAE,CAAC,EAAE,MAAM,EAAE,uBAAuB,EAAE,CAAC;gBAC3H,uBAAA,IAAI,2BAAa,CAAC,SAAS,CAAC,kCAAS,CAAC,IAAI,CAAC,WAAW,EAAE,QAAQ,CAAC,CAAC;gBAElE,MAAM,CAAC,CAAC;aACT;QACH,CAAC;KAAA;IAEM,YAAY;QACjB,MAAM,SAAS,GAAG,uBAAA,IAAI,6BAAe,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;QACvD,uBAAA,IAAI,sBAAe,SAAS,CAAC,UAAU,MAAA,CAAC;QACxC,uBAAA,IAAI,eAAQ,SAAS,CAAC,GAAG,MAAA,CAAC;QAC1B,uBAAA,IAAI,uBAAgB,SAAS,CAAC,WAAW,MAAA,CAAC;QAC1C,uBAAA,IAAI,iBAAU,SAAS,CAAC,KAAK,MAAA,CAAC;QAC9B,uBAAA,IAAI,kBAAW,SAAS,CAAC,MAAM,MAAA,CAAC;QAChC,uBAAA,IAAI,mBAAY,SAAS,CAAC,OAAO,MAAA,CAAC;QAClC,uBAAA,IAAI,mBAAY,SAAS,CAAC,OAAO,MAAA,CAAC;QAClC,uBAAA,IAAI,iBAAU,SAAS,CAAC,KAAK,MAAA,CAAC;QAC9B,uBAAA,IAAI,mBAAY,SAAS,CAAC,OAAO,MAAA,CAAC;QAClC,uBAAA,IAAI,eAAQ,SAAS,CAAC,GAAG,MAAA,CAAC;QAC1B,uBAAA,IAAI,oBAAa,SAAS,CAAC,QAAQ,MAAA,CAAC;QACpC,uBAAA,IAAI,kBAAW,SAAS,CAAC,MAAM,MAAA,CAAC;QAChC,uBAAA,IAAI,8BAAuB,SAAS,CAAC,kBAAkB,MAAA,CAAC;QACxD,uBAAA,IAAI,0BAAmB,SAAS,CAAC,cAAc,MAAA,CAAC;QAChD,uBAAA,IAAI,iBAAU,SAAS,CAAC,KAAK,MAAA,CAAC;IAChC,CAAC;IAEM,sBAAsB,CAAC,SAAmC;QAC/D,uBAAA,IAAI,sBAAe,SAAS,CAAC,UAAU,MAAA,CAAC;QACxC,uBAAA,IAAI,eAAQ,SAAS,CAAC,GAAG,MAAA,CAAC;QAC1B,uBAAA,IAAI,uBAAgB,SAAS,CAAC,WAAW,MAAA,CAAC;QAC1C,uBAAA,IAAI,iBAAU,SAAS,CAAC,KAAK,MAAA,CAAC;QAC9B,uBAAA,IAAI,kBAAW,SAAS,CAAC,MAAM,MAAA,CAAC;QAChC,uBAAA,IAAI,mBAAY,SAAS,CAAC,OAAO,MAAA,CAAC;QAClC,uBAAA,IAAI,mBAAY,SAAS,CAAC,OAAO,MAAA,CAAC;QAClC,uBAAA,IAAI,iBAAU,SAAS,CAAC,KAAK,MAAA,CAAC;QAC9B,uBAAA,IAAI,mBAAY,SAAS,CAAC,OAAO,MAAA,CAAC;QAClC,uBAAA,IAAI,eAAQ,SAAS,CAAC,GAAG,MAAA,CAAC;QAC1B,uBAAA,IAAI,oBAAa,SAAS,CAAC,QAAQ,MAAA,CAAC;QACpC,uBAAA,IAAI,kBAAW,SAAS,CAAC,MAAM,MAAA,CAAC;QAChC,uBAAA,IAAI,8BAAuB,SAAS,CAAC,kBAAkB,MAAA,CAAC;QACxD,uBAAA,IAAI,0BAAmB,SAAS,CAAC,cAAc,MAAA,CAAC;QAChD,uBAAA,IAAI,iBAAU,SAAS,CAAC,KAAK,MAAA,CAAC;IAChC,CAAC;CAGF;AAtND,wBAsNC","sourcesContent":["import { ShapeDiverResponseExport, ShapeDiverResponseExportContent, ShapeDiverResponseExportDefinitionType, ShapeDiverResponseExportResult, ShapeDiverResponseModelComputationStatus, ShapeDiverResponseParameterGroup } from \"@shapediver/sdk.geometry-api-sdk-v2\";\r\nimport { EventEngine, EVENTTYPE, InputValidator, Logger, UuidGenerator } from \"@shapediver/viewer.shared.services\";\r\nimport { ITaskEvent, TASK_TYPE } from \"@shapediver/viewer.shared.types\";\r\nimport { IExport } from \"../../interfaces/dto/IExport\";\r\nimport { SessionEngine } from \"../SessionEngine\";\r\n\r\nexport class Export implements IExport {\r\n  // #region Properties (24)\r\n\r\n  readonly #eventEngine: EventEngine = EventEngine.instance;\r\n  readonly #id: string;\r\n  readonly #inputValidator: InputValidator = InputValidator.instance;\r\n  readonly #logger: Logger = Logger.instance;\r\n  readonly #name: string;\r\n  readonly #sessionEngine: SessionEngine;\r\n  readonly #type: ShapeDiverResponseExportDefinitionType;\r\n  readonly #uuidGenerator: UuidGenerator = UuidGenerator.instance;\r\n\r\n  #content?: ShapeDiverResponseExportContent[];\r\n  #delay?: number;\r\n  #dependency!: string[];\r\n  #displayname?: string;\r\n  #filename?: string;\r\n  #group?: ShapeDiverResponseParameterGroup;\r\n  #hidden: boolean = false;\r\n  #maxWaitTime: number = 300000;\r\n  #msg?: string\r\n  #order?: number;\r\n  #result?: ShapeDiverResponseExportResult\r\n  #status_collect?: ShapeDiverResponseModelComputationStatus;\r\n  #status_computation?: ShapeDiverResponseModelComputationStatus;\r\n  #tooltip?: string;\r\n  #uid?: string;\r\n  #version?: string;\r\n\r\n  // #endregion Properties (24)\r\n\r\n  // #region Constructors (1)\r\n\r\n  constructor(exportDef: ShapeDiverResponseExport, sessionEngine: SessionEngine) {\r\n    this.#sessionEngine = sessionEngine;\r\n    this.#id = exportDef.id;\r\n    this.#name = exportDef.name;\r\n    this.#type = exportDef.type;\r\n\r\n    this.updateExportDefinition(exportDef);\r\n  }\r\n\r\n  // #endregion Constructors (1)\r\n\r\n  // #region Public Accessors (24)\r\n\r\n  public get content(): ShapeDiverResponseExportContent[] | undefined {\r\n    return this.#content;\r\n  }\r\n\r\n  public get delay(): number | undefined {\r\n    return this.#delay;\r\n  }\r\n\r\n  public get dependency(): string[] {\r\n    return this.#dependency;\r\n  }\r\n\r\n  public get displayname(): string | undefined {\r\n    return this.#displayname;\r\n  }\r\n\r\n  public set displayname(value: string | undefined) {\r\n    this.#displayname = value;\r\n  }\r\n\r\n  public get filename(): string | undefined {\r\n    return this.#filename;\r\n  }\r\n\r\n  public get group(): ShapeDiverResponseParameterGroup | undefined {\r\n    return this.#group;\r\n  }\r\n\r\n  public get hidden(): boolean {\r\n    return this.#hidden;\r\n  }\r\n\r\n  public set hidden(value: boolean) {\r\n    this.#hidden = value;\r\n  }\r\n\r\n  public get id(): string {\r\n    return this.#id;\r\n  }\r\n\r\n  public get maxWaitTime(): number {\r\n    return this.#maxWaitTime;\r\n  }\r\n\r\n  public set maxWaitTime(value: number) {\r\n    this.#maxWaitTime = value;\r\n  }\r\n\r\n  public get msg(): string | undefined {\r\n    return this.#msg;\r\n  }\r\n\r\n  public get name(): string {\r\n    return this.#name;\r\n  }\r\n\r\n  public get order(): number | undefined {\r\n    return this.#order;\r\n  }\r\n\r\n  public set order(value: number | undefined) {\r\n    this.#order = value;\r\n  }\r\n\r\n  public get result(): ShapeDiverResponseExportResult | undefined {\r\n    return this.#result;\r\n  }\r\n\r\n  public get status_collect(): ShapeDiverResponseModelComputationStatus | undefined {\r\n    return this.#status_collect;\r\n  }\r\n\r\n  public get status_computation(): ShapeDiverResponseModelComputationStatus | undefined {\r\n    return this.#status_computation;\r\n  }\r\n\r\n  public get tooltip(): string | undefined {\r\n    return this.#tooltip;\r\n  }\r\n\r\n  public set tooltip(value: string | undefined) {\r\n    this.#tooltip = value;\r\n  }\r\n\r\n  public get type(): ShapeDiverResponseExportDefinitionType {\r\n    return this.#type;\r\n  }\r\n\r\n  public get uid(): string | undefined {\r\n    return this.#uid;\r\n  }\r\n\r\n  public get version(): string | undefined {\r\n    return this.#version;\r\n  }\r\n\r\n  // #endregion Public Accessors (24)\r\n\r\n  // #region Public Methods (3)\r\n\r\n  public async request(parameters: { [key: string]: string } = {}): Promise<ShapeDiverResponseExport> {\r\n    const eventId = this.#uuidGenerator.create();\r\n    try {\r\n      const event: ITaskEvent = { type: TASK_TYPE.EXPORT_REQUEST, id: eventId, progress: 0, status: 'Requesting export' };\r\n      this.#eventEngine.emitEvent(EVENTTYPE.TASK.TASK_START, event);\r\n\r\n      this.#logger.debugLow(`Export(${this.#id}).request: Sending export request.`);\r\n      const currentParameters = this.#sessionEngine.parameterValues;\r\n      const exportParameters: { [key: string]: string } = {}\r\n\r\n      for (let parameter in currentParameters)\r\n        exportParameters[parameter] = parameters[parameter] || parameters[parameter] === '' ? parameters[parameter] : currentParameters[parameter];\r\n\r\n      this.#logger.info(`Export(${this.#id}).request: Sending export request with parameters ${JSON.stringify(exportParameters)}.`);\r\n\r\n      const exportDef = await this.#sessionEngine.requestExport(this.id, exportParameters, this.#maxWaitTime);\r\n      this.updateExportDefinition(exportDef);\r\n\r\n      const eventEnd: ITaskEvent = { type: TASK_TYPE.EXPORT_REQUEST, id: eventId, progress: 1, status: 'Returning export' };\r\n      this.#eventEngine.emitEvent(EVENTTYPE.TASK.TASK_END, eventEnd);\r\n\r\n      return exportDef;\r\n    } catch (e) {\r\n      const eventEnd: ITaskEvent = { type: TASK_TYPE.EXPORT_REQUEST, id: eventId, progress: 1, status: 'Export request failed' };\r\n      this.#eventEngine.emitEvent(EVENTTYPE.TASK.TASK_CANCEL, eventEnd);\r\n\r\n      throw e;\r\n    }\r\n  }\r\n\r\n  public updateExport() {\r\n    const exportDef = this.#sessionEngine.exports[this.id];\r\n    this.#dependency = exportDef.dependency;\r\n    this.#uid = exportDef.uid;\r\n    this.#displayname = exportDef.displayname;\r\n    this.#order = exportDef.order;\r\n    this.#hidden = exportDef.hidden;\r\n    this.#tooltip = exportDef.tooltip;\r\n    this.#version = exportDef.version;\r\n    this.#delay = exportDef.delay;\r\n    this.#content = exportDef.content;\r\n    this.#msg = exportDef.msg;\r\n    this.#filename = exportDef.filename;\r\n    this.#result = exportDef.result;\r\n    this.#status_computation = exportDef.status_computation;\r\n    this.#status_collect = exportDef.status_collect;\r\n    this.#group = exportDef.group;\r\n  }\r\n\r\n  public updateExportDefinition(exportDef: ShapeDiverResponseExport) {\r\n    this.#dependency = exportDef.dependency;\r\n    this.#uid = exportDef.uid;\r\n    this.#displayname = exportDef.displayname;\r\n    this.#order = exportDef.order;\r\n    this.#hidden = exportDef.hidden;\r\n    this.#tooltip = exportDef.tooltip;\r\n    this.#version = exportDef.version;\r\n    this.#delay = exportDef.delay;\r\n    this.#content = exportDef.content;\r\n    this.#msg = exportDef.msg;\r\n    this.#filename = exportDef.filename;\r\n    this.#result = exportDef.result;\r\n    this.#status_computation = exportDef.status_computation;\r\n    this.#status_collect = exportDef.status_collect;\r\n    this.#group = exportDef.group;\r\n  }\r\n\r\n  // #endregion Public Methods (3)\r\n}"]}},"error":null,"hash":"42076a7bb47ecf4c59cd93683764a5ac","cacheData":{"env":{}}}