{"id":"uocf","dependencies":[{"name":"F:\\UpworkProjects\\ShapeDiverLight\\ShapeDiverLight\\shapediverlight.client\\node_modules\\@shapediver\\viewer.data-engine.geometry-engine\\dist\\gltfv2\\loaders\\TextureLoader.js.map","includedInParent":true,"mtime":1706476152508},{"name":"F:\\UpworkProjects\\ShapeDiverLight\\ShapeDiverLight\\shapediverlight.client\\node_modules\\@shapediver\\viewer.data-engine.geometry-engine\\src\\gltfv2\\loaders\\TextureLoader.ts","includedInParent":true,"mtime":1706476152739},{"name":"F:\\UpworkProjects\\ShapeDiverLight\\ShapeDiverLight\\shapediverlight.client\\package.json","includedInParent":true,"mtime":1706476652643},{"name":"F:\\UpworkProjects\\ShapeDiverLight\\ShapeDiverLight\\shapediverlight.client\\node_modules\\@shapediver\\viewer.data-engine.geometry-engine\\package.json","includedInParent":true,"mtime":1706476151913},{"name":"@shapediver/viewer.shared.services","loc":{"line":13,"column":41,"index":843},"parent":"F:\\UpworkProjects\\ShapeDiverLight\\ShapeDiverLight\\shapediverlight.client\\node_modules\\@shapediver\\viewer.data-engine.geometry-engine\\dist\\gltfv2\\loaders\\TextureLoader.js","resolved":"F:\\UpworkProjects\\ShapeDiverLight\\ShapeDiverLight\\shapediverlight.client\\node_modules\\@shapediver\\viewer.shared.services\\dist\\index.js"}],"generated":{"js":"\"use strict\";var e=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(i,o){function s(e){try{h(n.next(e))}catch(t){o(t)}}function a(e){try{h(n.throw(e))}catch(t){o(t)}}function h(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(s,a)}h((n=n.apply(e,t||[])).next())})};Object.defineProperty(exports,\"__esModule\",{value:!0}),exports.TextureLoader=void 0;const t=require(\"@shapediver/viewer.shared.services\");class r{constructor(e,r,n){this._content=e,this._bufferViewLoader=r,this._baseUri=n,this._converter=t.Converter.instance,this._httpClient=t.HttpClient.instance,this._loaded={}}getTexture(e){if(!this._content.textures)throw new Error(\"TextureLoader.getTexture: Textures not available.\");if(!this._content.textures[e])throw new Error(\"TextureLoader.getTexture: Texture not available.\");if(!this._loaded[e])throw new Error(\"TextureLoader.getTexture: Texture not loaded.\");return this._loaded[e]}load(){return e(this,void 0,void 0,function*(){if(!this._content.textures)return;let e=[];for(let t=0;t<this._content.textures.length;t++){const r=t,n=this._content.textures[r];if(!this._content.images)throw new Error(\"TextureLoader.load: Images not available.\");const i=this._content.images[n.source],o=/^data:(.*?)(;base64)?,(.*)$/,s=/^https:\\/\\//;if(void 0!==i.bufferView){const t=this._bufferViewLoader.getBufferView(i.bufferView),n=new DataView(t),o=[];for(let e=0;e<n.byteLength;e+=1)o[e]=n.getUint8(e);const s=new Blob([new Uint8Array(o)],{type:i.mimeType}),a=URL.createObjectURL(s);e.push(new Promise((e,t)=>{this._httpClient.loadTexture(a).then(n=>{this._converter.responseToImage(n).then(t=>{this._loaded[r]=t,URL.revokeObjectURL(a),e()}).catch(e=>t(e))})}))}else{const t=o.test(i.uri)||s.test(i.uri)?i.uri:`${this._baseUri}/${i.uri}`;e.push(new Promise((e,n)=>{this._httpClient.loadTexture(t).then(t=>{this._converter.responseToImage(t).then(t=>{this._loaded[r]=t,e()})}).catch(e=>n(e))}))}}yield Promise.all(e)})}}exports.TextureLoader=r;"},"sourceMaps":{"js":{"mappings":[{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":2,"column":0},"generated":{"line":1,"column":413}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":2,"column":0},"generated":{"line":1,"column":419}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":2,"column":0},"generated":{"line":1,"column":421}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":2,"column":0},"generated":{"line":1,"column":429}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":6,"column":0},"generated":{"line":1,"column":467}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":6,"column":13},"generated":{"line":1,"column":473}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":20,"column":4},"generated":{"line":1,"column":475}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":20,"column":33},"generated":{"line":1,"column":487}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":20,"column":70},"generated":{"line":1,"column":489}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":20,"column":115},"generated":{"line":1,"column":491}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":20,"column":33},"generated":{"line":1,"column":494}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":20,"column":33},"generated":{"line":1,"column":499}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":20,"column":33},"generated":{"line":1,"column":508}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":20,"column":70},"generated":{"line":1,"column":510}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":20,"column":70},"generated":{"line":1,"column":515}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":20,"column":70},"generated":{"line":1,"column":533}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":20,"column":115},"generated":{"line":1,"column":535}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":20,"column":115},"generated":{"line":1,"column":540}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":20,"column":115},"generated":{"line":1,"column":549}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":9,"column":21},"generated":{"line":1,"column":551}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":9,"column":21},"generated":{"line":1,"column":556}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":9,"column":45},"generated":{"line":1,"column":567}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":9,"column":45},"generated":{"line":1,"column":569}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":9,"column":55},"generated":{"line":1,"column":579}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":10,"column":21},"generated":{"line":1,"column":588}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":10,"column":21},"generated":{"line":1,"column":593}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":10,"column":47},"generated":{"line":1,"column":605}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":10,"column":47},"generated":{"line":1,"column":607}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":10,"column":58},"generated":{"line":1,"column":618}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":12,"column":12},"generated":{"line":1,"column":627}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":12,"column":12},"generated":{"line":1,"column":632}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":14,"column":8},"generated":{"line":1,"column":640}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":26,"column":11},"generated":{"line":1,"column":643}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":26,"column":22},"generated":{"line":1,"column":654}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":27,"column":8},"generated":{"line":1,"column":657}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":27,"column":13},"generated":{"line":1,"column":661}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":27,"column":18},"generated":{"line":1,"column":666}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":27,"column":27},"generated":{"line":1,"column":675}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":27,"column":37},"generated":{"line":1,"column":684}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":27,"column":43},"generated":{"line":1,"column":690}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":27,"column":47},"generated":{"line":1,"column":694}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":27,"column":53},"generated":{"line":1,"column":700}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":28,"column":8},"generated":{"line":1,"column":753}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":28,"column":13},"generated":{"line":1,"column":757}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":28,"column":18},"generated":{"line":1,"column":762}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":28,"column":27},"generated":{"line":1,"column":771}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":28,"column":36},"generated":{"line":1,"column":780}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":28,"column":48},"generated":{"line":1,"column":783}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":28,"column":54},"generated":{"line":1,"column":789}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":28,"column":58},"generated":{"line":1,"column":793}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":28,"column":64},"generated":{"line":1,"column":799}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":29,"column":8},"generated":{"line":1,"column":851}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":29,"column":13},"generated":{"line":1,"column":855}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":29,"column":18},"generated":{"line":1,"column":860}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":29,"column":26},"generated":{"line":1,"column":868}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":29,"column":38},"generated":{"line":1,"column":871}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":29,"column":44},"generated":{"line":1,"column":877}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":29,"column":48},"generated":{"line":1,"column":881}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":29,"column":54},"generated":{"line":1,"column":887}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":30,"column":8},"generated":{"line":1,"column":936}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":30,"column":15},"generated":{"line":1,"column":943}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":30,"column":20},"generated":{"line":1,"column":948}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":30,"column":28},"generated":{"line":1,"column":956}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":33,"column":17},"generated":{"line":1,"column":959}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":34,"column":8},"generated":{"line":1,"column":1006}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":34,"column":13},"generated":{"line":1,"column":1010}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":34,"column":18},"generated":{"line":1,"column":1015}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":34,"column":27},"generated":{"line":1,"column":1024}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":34,"column":37},"generated":{"line":1,"column":1033}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":36,"column":8},"generated":{"line":1,"column":1040}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":36,"column":12},"generated":{"line":1,"column":1044}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":36,"column":40},"generated":{"line":1,"column":1046}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":37,"column":8},"generated":{"line":1,"column":1049}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":37,"column":12},"generated":{"line":1,"column":1053}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":37,"column":16},"generated":{"line":1,"column":1057}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":37,"column":20},"generated":{"line":1,"column":1059}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":37,"column":23},"generated":{"line":1,"column":1061}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":37,"column":27},"generated":{"line":1,"column":1063}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":37,"column":32},"generated":{"line":1,"column":1068}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":37,"column":41},"generated":{"line":1,"column":1077}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":37,"column":50},"generated":{"line":1,"column":1086}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":37,"column":58},"generated":{"line":1,"column":1093}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":37,"column":63},"generated":{"line":1,"column":1097}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":38,"column":12},"generated":{"line":1,"column":1098}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":38,"column":18},"generated":{"line":1,"column":1104}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":38,"column":30},"generated":{"line":1,"column":1106}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":39,"column":18},"generated":{"line":1,"column":1108}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":39,"column":28},"generated":{"line":1,"column":1110}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":39,"column":33},"generated":{"line":1,"column":1115}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":39,"column":42},"generated":{"line":1,"column":1124}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":39,"column":51},"generated":{"line":1,"column":1133}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":40,"column":12},"generated":{"line":1,"column":1136}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":40,"column":17},"generated":{"line":1,"column":1140}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":40,"column":22},"generated":{"line":1,"column":1145}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":40,"column":31},"generated":{"line":1,"column":1154}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":40,"column":39},"generated":{"line":1,"column":1161}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":40,"column":45},"generated":{"line":1,"column":1167}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":40,"column":49},"generated":{"line":1,"column":1171}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":40,"column":55},"generated":{"line":1,"column":1177}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":41,"column":12},"generated":{"line":1,"column":1222}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":41,"column":18},"generated":{"line":1,"column":1228}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":41,"column":26},"generated":{"line":1,"column":1230}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":41,"column":31},"generated":{"line":1,"column":1235}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":41,"column":40},"generated":{"line":1,"column":1244}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":41,"column":47},"generated":{"line":1,"column":1251}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":41,"column":55},"generated":{"line":1,"column":1253}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":43,"column":18},"generated":{"line":1,"column":1261}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":43,"column":35},"generated":{"line":1,"column":1263}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":44,"column":18},"generated":{"line":1,"column":1293}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":44,"column":36},"generated":{"line":1,"column":1295}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":46,"column":12},"generated":{"line":1,"column":1309}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":46,"column":37},"generated":{"line":1,"column":1317}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":46,"column":16},"generated":{"line":1,"column":1321}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":46,"column":22},"generated":{"line":1,"column":1323}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":46,"column":48},"generated":{"line":1,"column":1334}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":47,"column":16},"generated":{"line":1,"column":1335}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":47,"column":22},"generated":{"line":1,"column":1341}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":47,"column":35},"generated":{"line":1,"column":1343}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":47,"column":40},"generated":{"line":1,"column":1348}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":47,"column":58},"generated":{"line":1,"column":1366}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":47,"column":72},"generated":{"line":1,"column":1380}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":47,"column":78},"generated":{"line":1,"column":1382}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":48,"column":22},"generated":{"line":1,"column":1394}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":48,"column":33},"generated":{"line":1,"column":1396}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":48,"column":37},"generated":{"line":1,"column":1400}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":48,"column":46},"generated":{"line":1,"column":1409}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":49,"column":22},"generated":{"line":1,"column":1412}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":49,"column":45},"generated":{"line":1,"column":1414}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":50,"column":16},"generated":{"line":1,"column":1417}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":50,"column":21},"generated":{"line":1,"column":1421}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":50,"column":25},"generated":{"line":1,"column":1425}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":50,"column":29},"generated":{"line":1,"column":1427}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":50,"column":32},"generated":{"line":1,"column":1429}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":50,"column":36},"generated":{"line":1,"column":1431}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":50,"column":45},"generated":{"line":1,"column":1433}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":50,"column":57},"generated":{"line":1,"column":1444}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":50,"column":62},"generated":{"line":1,"column":1447}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":51,"column":20},"generated":{"line":1,"column":1449}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":51,"column":26},"generated":{"line":1,"column":1451}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":51,"column":31},"generated":{"line":1,"column":1454}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":51,"column":40},"generated":{"line":1,"column":1456}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":51,"column":49},"generated":{"line":1,"column":1465}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":53,"column":16},"generated":{"line":1,"column":1468}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":53,"column":22},"generated":{"line":1,"column":1474}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":53,"column":29},"generated":{"line":1,"column":1476}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":53,"column":33},"generated":{"line":1,"column":1480}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":53,"column":38},"generated":{"line":1,"column":1485}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":53,"column":39},"generated":{"line":1,"column":1486}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":53,"column":43},"generated":{"line":1,"column":1490}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":53,"column":54},"generated":{"line":1,"column":1501}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":53,"column":63},"generated":{"line":1,"column":1505}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":53,"column":65},"generated":{"line":1,"column":1506}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":53,"column":71},"generated":{"line":1,"column":1511}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":53,"column":77},"generated":{"line":1,"column":1513}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":54,"column":22},"generated":{"line":1,"column":1524}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":54,"column":32},"generated":{"line":1,"column":1526}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":54,"column":36},"generated":{"line":1,"column":1530}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":54,"column":52},"generated":{"line":1,"column":1546}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":56,"column":16},"generated":{"line":1,"column":1549}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":56,"column":25},"generated":{"line":1,"column":1551}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":57,"column":20},"generated":{"line":1,"column":1556}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":57,"column":24},"generated":{"line":1,"column":1560}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":57,"column":38},"generated":{"line":1,"column":1568}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":57,"column":39},"generated":{"line":1,"column":1569}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":57,"column":48},"generated":{"line":1,"column":1571}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":58,"column":24},"generated":{"line":1,"column":1576}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":58,"column":29},"generated":{"line":1,"column":1581}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":58,"column":41},"generated":{"line":1,"column":1593}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":58,"column":53},"generated":{"line":1,"column":1605}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":59,"column":29},"generated":{"line":1,"column":1608}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":59,"column":34},"generated":{"line":1,"column":1613}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":60,"column":32},"generated":{"line":1,"column":1617}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":60,"column":37},"generated":{"line":1,"column":1622}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":60,"column":48},"generated":{"line":1,"column":1633}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":60,"column":64},"generated":{"line":1,"column":1649}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":60,"column":74},"generated":{"line":1,"column":1652}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":60,"column":79},"generated":{"line":1,"column":1657}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":61,"column":36},"generated":{"line":1,"column":1661}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":61,"column":41},"generated":{"line":1,"column":1666}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":61,"column":49},"generated":{"line":1,"column":1674}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":61,"column":62},"generated":{"line":1,"column":1677}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":62,"column":36},"generated":{"line":1,"column":1679}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":62,"column":40},"generated":{"line":1,"column":1683}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":62,"column":56},"generated":{"line":1,"column":1699}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":63,"column":36},"generated":{"line":1,"column":1702}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":64,"column":35},"generated":{"line":1,"column":1708}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":64,"column":41},"generated":{"line":1,"column":1714}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":64,"column":46},"generated":{"line":1,"column":1717}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":64,"column":53},"generated":{"line":1,"column":1719}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":68,"column":19},"generated":{"line":1,"column":1732}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":69,"column":16},"generated":{"line":1,"column":1733}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":69,"column":22},"generated":{"line":1,"column":1739}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":69,"column":28},"generated":{"line":1,"column":1741}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":69,"column":43},"generated":{"line":1,"column":1743}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":69,"column":48},"generated":{"line":1,"column":1748}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":69,"column":54},"generated":{"line":1,"column":1750}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":69,"column":63},"generated":{"line":1,"column":1756}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":69,"column":79},"generated":{"line":1,"column":1758}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":69,"column":84},"generated":{"line":1,"column":1763}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":69,"column":90},"generated":{"line":1,"column":1765}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":69,"column":98},"generated":{"line":1,"column":1770}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":69,"column":104},"generated":{"line":1,"column":1772}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":69,"column":113},"generated":{"line":1,"column":1779}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":69,"column":118},"generated":{"line":1,"column":1784}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":69,"column":130},"generated":{"line":1,"column":1796}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":69,"column":136},"generated":{"line":1,"column":1798}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":70,"column":16},"generated":{"line":1,"column":1804}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":70,"column":25},"generated":{"line":1,"column":1806}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":71,"column":20},"generated":{"line":1,"column":1811}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":71,"column":24},"generated":{"line":1,"column":1815}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":71,"column":38},"generated":{"line":1,"column":1823}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":71,"column":39},"generated":{"line":1,"column":1824}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":71,"column":48},"generated":{"line":1,"column":1826}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":72,"column":24},"generated":{"line":1,"column":1831}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":72,"column":29},"generated":{"line":1,"column":1836}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":72,"column":41},"generated":{"line":1,"column":1848}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":72,"column":53},"generated":{"line":1,"column":1860}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":73,"column":29},"generated":{"line":1,"column":1863}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":73,"column":34},"generated":{"line":1,"column":1868}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":74,"column":32},"generated":{"line":1,"column":1872}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":74,"column":37},"generated":{"line":1,"column":1877}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":74,"column":48},"generated":{"line":1,"column":1888}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":74,"column":64},"generated":{"line":1,"column":1904}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":74,"column":74},"generated":{"line":1,"column":1907}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":74,"column":79},"generated":{"line":1,"column":1912}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":75,"column":36},"generated":{"line":1,"column":1916}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":75,"column":41},"generated":{"line":1,"column":1921}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":75,"column":49},"generated":{"line":1,"column":1929}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":75,"column":62},"generated":{"line":1,"column":1932}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":76,"column":36},"generated":{"line":1,"column":1934}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":78,"column":31},"generated":{"line":1,"column":1942}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":78,"column":37},"generated":{"line":1,"column":1948}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":78,"column":42},"generated":{"line":1,"column":1951}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":78,"column":49},"generated":{"line":1,"column":1953}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":84,"column":14},"generated":{"line":1,"column":1967}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":84,"column":22},"generated":{"line":1,"column":1975}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":84,"column":26},"generated":{"line":1,"column":1979}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":6,"column":0},"generated":{"line":1,"column":1985}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":6,"column":0},"generated":{"line":1,"column":1993}},{"source":"../../../src/gltfv2/loaders/TextureLoader.ts","name":null,"original":{"line":6,"column":0},"generated":{"line":1,"column":2007}}],"sources":{"../../../src/gltfv2/loaders/TextureLoader.ts":"import { IGLTF_v2 } from '@shapediver/viewer.data-engine.shared-types'\r\nimport { Converter, HttpClient } from '@shapediver/viewer.shared.services'\r\n\r\nimport { BufferViewLoader } from './BufferViewLoader'\r\n\r\nexport class TextureLoader {\r\n    // #region Properties (4)\r\n\r\n    private readonly _converter: Converter = Converter.instance;\r\n    private readonly _httpClient: HttpClient = HttpClient.instance;\r\n\r\n    private _loaded: {\r\n        [key: string]: HTMLImageElement\r\n    } = {};\r\n\r\n    // #endregion Properties (4)\r\n\r\n    // #region Constructors (1)\r\n\r\n    constructor(private readonly _content: IGLTF_v2, private readonly _bufferViewLoader: BufferViewLoader, private _baseUri?: string) { }\r\n\r\n    // #endregion Constructors (1)\r\n\r\n    // #region Public Methods (2)\r\n\r\n    public getTexture(textureId: number): HTMLImageElement {\r\n        if (!this._content.textures) throw new Error('TextureLoader.getTexture: Textures not available.')\r\n        if (!this._content.textures[textureId]) throw new Error('TextureLoader.getTexture: Texture not available.')\r\n        if (!this._loaded[textureId]) throw new Error('TextureLoader.getTexture: Texture not loaded.')\r\n        return this._loaded[textureId];\r\n    }\r\n\r\n    public async load(): Promise<void> {\r\n        if (!this._content.textures) return;\r\n\r\n        let promises: Promise<void>[] = [];\r\n        for(let i = 0; i < this._content.textures.length; i++) {\r\n            const textureId = i;\r\n            const texture = this._content.textures[textureId];\r\n            if (!this._content.images) throw new Error('TextureLoader.load: Images not available.')\r\n            const image = this._content.images[texture.source];\r\n    \r\n            const DATA_URI_REGEX = /^data:(.*?)(;base64)?,(.*)$/;\r\n            const HTTPS_URI_REGEX = /^https:\\/\\//;\r\n    \r\n            if (image.bufferView !== undefined) {\r\n                const bufferView = this._bufferViewLoader.getBufferView(image.bufferView);\r\n                const dataView = new DataView(bufferView);\r\n                const array: Array<number> = [];\r\n                for (let i = 0; i < dataView.byteLength; i += 1)\r\n                    array[i] = dataView.getUint8(i);\r\n    \r\n                const blob = new Blob([new Uint8Array(array)], { type: image.mimeType });\r\n                const dataUri = URL.createObjectURL(blob);\r\n    \r\n                promises.push(\r\n                    new Promise<void>((resolve, reject) => {\r\n                        this._httpClient.loadTexture(dataUri)\r\n                            .then(response => {\r\n                                this._converter.responseToImage(response).then(img => {\r\n                                    this._loaded[textureId] = img;\r\n                                    URL.revokeObjectURL(dataUri)\r\n                                    resolve()\r\n                                }).catch(e => reject(e));\r\n                            })\r\n                    })\r\n                );\r\n            } else {\r\n                const url = DATA_URI_REGEX.test(image.uri!) || HTTPS_URI_REGEX.test(image.uri!) ? image.uri : `${this._baseUri}/${image.uri}`;\r\n                promises.push(\r\n                    new Promise<void>((resolve, reject) => {\r\n                        this._httpClient.loadTexture(url!)\r\n                            .then(response => {\r\n                                this._converter.responseToImage(response).then(img => {\r\n                                    this._loaded[textureId] = img;\r\n                                    resolve()\r\n                                });\r\n                            }).catch(e => reject(e));\r\n                    })\r\n                );\r\n            }\r\n        }\r\n\r\n        await Promise.all(promises);\r\n    }\r\n\r\n    // #endregion Public Methods (2)\r\n}"},"lineCount":null}},"error":null,"hash":"e3d7526121d108c31cb9c163336bf6a9","cacheData":{"env":{}}}