{"id":"UyMv","dependencies":[{"name":"F:\\UpworkProjects\\ShapeDiverLight\\ShapeDiverLight\\shapediverlight.client\\node_modules\\@shapediver\\viewer.shared.services\\dist\\http-client\\HttpClient.js.map","includedInParent":true,"mtime":1706476151268},{"name":"F:\\UpworkProjects\\ShapeDiverLight\\ShapeDiverLight\\shapediverlight.client\\node_modules\\@shapediver\\viewer.shared.services\\src\\http-client\\HttpClient.ts","includedInParent":true,"mtime":1706476151940},{"name":"F:\\UpworkProjects\\ShapeDiverLight\\ShapeDiverLight\\shapediverlight.client\\package.json","includedInParent":true,"mtime":1706476652643},{"name":"F:\\UpworkProjects\\ShapeDiverLight\\ShapeDiverLight\\shapediverlight.client\\node_modules\\@shapediver\\viewer.shared.services\\package.json","includedInParent":true,"mtime":1706476151036},{"name":"axios","loc":{"line":16,"column":40,"index":981},"parent":"F:\\UpworkProjects\\ShapeDiverLight\\ShapeDiverLight\\shapediverlight.client\\node_modules\\@shapediver\\viewer.shared.services\\dist\\http-client\\HttpClient.js","resolved":"F:\\UpworkProjects\\ShapeDiverLight\\ShapeDiverLight\\shapediverlight.client\\node_modules\\axios\\index.js"},{"name":"@shapediver/sdk.geometry-api-sdk-v2","loc":{"line":17,"column":42,"index":1035},"parent":"F:\\UpworkProjects\\ShapeDiverLight\\ShapeDiverLight\\shapediverlight.client\\node_modules\\@shapediver\\viewer.shared.services\\dist\\http-client\\HttpClient.js","resolved":"F:\\UpworkProjects\\ShapeDiverLight\\ShapeDiverLight\\shapediverlight.client\\node_modules\\@shapediver\\sdk.geometry-api-sdk-v2\\dist\\index.js"},{"name":"../logger/ShapeDiverBackendErrors","loc":{"line":18,"column":42,"index":1118},"parent":"F:\\UpworkProjects\\ShapeDiverLight\\ShapeDiverLight\\shapediverlight.client\\node_modules\\@shapediver\\viewer.shared.services\\dist\\http-client\\HttpClient.js","resolved":"F:\\UpworkProjects\\ShapeDiverLight\\ShapeDiverLight\\shapediverlight.client\\node_modules\\@shapediver\\viewer.shared.services\\dist\\logger\\ShapeDiverBackendErrors.js"}],"generated":{"js":"\"use strict\";var e=this&&this.__awaiter||function(e,t,s,r){return new(s||(s=Promise))(function(n,o){function i(e){try{c(r.next(e))}catch(t){o(t)}}function a(e){try{c(r.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s(function(e){e(t)})).then(i,a)}c((r=r.apply(e,t||[])).next())})},t=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,\"__esModule\",{value:!0}),exports.HttpClient=void 0;const s=t(require(\"axios\")),r=require(\"@shapediver/sdk.geometry-api-sdk-v2\"),n=require(\"../logger/ShapeDiverBackendErrors\");class o{constructor(){this._sessionLoading={}}static get instance(){return this._instance||(this._instance=new this)}addDataLoading(e,t){this._sessionLoading[e]=t}convertError(e){throw e instanceof r.ShapeDiverResponseError?new n.ShapeDiverGeometryBackendResponseError(e.message,e.status,e.error,e.desc):e instanceof r.ShapeDiverRequestError?new n.ShapeDiverGeometryBackendRequestError(e.message,e.desc):e}get(t,r={responseType:\"arraybuffer\"},n=!1){return e(this,void 0,void 0,function*(){let e,o=this.getSessionId(t);return!o&&Object.keys(this._sessionLoading).length>0&&(o=Object.keys(this._sessionLoading)[0]),o&&(e=this._sessionLoading[o]),n?void 0===e||void 0===o||t.startsWith(\"blob:\")||t.startsWith(\"data:\")?(0,s.default)(t,Object.assign({method:\"get\"},r)).catch(e=>{throw this.convertError(e)}):new Promise((s,r)=>{e.downloadTexture(o,t).then(e=>{s({data:e[0],headers:{\"content-type\":e[1]}})}).catch(e=>r(e))}).catch(e=>{throw this.convertError(e)}):e?new Promise((n,o)=>{e.getAsset(t).then(e=>{n({data:e[0],headers:{\"content-type\":e[1]}})}).catch(()=>{const e=(0,s.default)(t,Object.assign({method:\"get\"},r));e.catch(e=>o(e)),n(e)})}).catch(e=>{throw this.convertError(e)}):(0,s.default)(t,Object.assign({method:\"get\"},r)).catch(e=>{throw this.convertError(e)})})}loadTexture(t){return e(this,void 0,void 0,function*(){return this.get(t,void 0,!0)})}removeDataLoading(e){delete this._sessionLoading[e]}getSessionId(e){const t=e.split(\"/\"),s=t.indexOf(\"session\");if(-1!==s&&t.length===s+4){const e=t[s+1];if(!this._sessionLoading[e])return;return e}}}exports.HttpClient=o;"},"sourceMaps":{"js":{"mappings":[{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":1,"column":0},"generated":{"line":1,"column":490}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":1,"column":0},"generated":{"line":1,"column":496}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":1,"column":0},"generated":{"line":1,"column":498}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":1,"column":0},"generated":{"line":1,"column":500}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":1,"column":0},"generated":{"line":1,"column":508}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":2,"column":0},"generated":{"line":1,"column":518}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":2,"column":0},"generated":{"line":1,"column":520}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":2,"column":0},"generated":{"line":1,"column":528}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":3,"column":0},"generated":{"line":1,"column":567}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":3,"column":0},"generated":{"line":1,"column":569}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":3,"column":0},"generated":{"line":1,"column":577}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":6,"column":0},"generated":{"line":1,"column":614}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":6,"column":13},"generated":{"line":1,"column":620}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":22,"column":4},"generated":{"line":1,"column":622}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":11,"column":12},"generated":{"line":1,"column":636}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":11,"column":12},"generated":{"line":1,"column":641}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":16,"column":8},"generated":{"line":1,"column":657}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":28,"column":11},"generated":{"line":1,"column":660}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":29,"column":8},"generated":{"line":1,"column":682}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":29,"column":15},"generated":{"line":1,"column":689}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":29,"column":20},"generated":{"line":1,"column":694}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":29,"column":34},"generated":{"line":1,"column":706}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":29,"column":39},"generated":{"line":1,"column":711}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":29,"column":51},"generated":{"line":1,"column":721}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":29,"column":55},"generated":{"line":1,"column":725}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":36,"column":11},"generated":{"line":1,"column":731}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":36,"column":26},"generated":{"line":1,"column":746}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":36,"column":45},"generated":{"line":1,"column":748}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":40,"column":8},"generated":{"line":1,"column":751}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":40,"column":13},"generated":{"line":1,"column":756}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":40,"column":29},"generated":{"line":1,"column":772}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":40,"column":42},"generated":{"line":1,"column":775}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":52,"column":11},"generated":{"line":1,"column":777}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":52,"column":24},"generated":{"line":1,"column":790}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":53,"column":8},"generated":{"line":1,"column":793}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":53,"column":12},"generated":{"line":1,"column":799}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":53,"column":25},"generated":{"line":1,"column":812}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":53,"column":25},"generated":{"line":1,"column":814}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":54,"column":18},"generated":{"line":1,"column":838}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":54,"column":22},"generated":{"line":1,"column":842}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":54,"column":22},"generated":{"line":1,"column":844}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":54,"column":61},"generated":{"line":1,"column":883}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":54,"column":63},"generated":{"line":1,"column":885}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":54,"column":72},"generated":{"line":1,"column":893}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":54,"column":74},"generated":{"line":1,"column":895}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":54,"column":82},"generated":{"line":1,"column":902}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":54,"column":84},"generated":{"line":1,"column":904}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":54,"column":91},"generated":{"line":1,"column":910}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":54,"column":93},"generated":{"line":1,"column":912}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":55,"column":19},"generated":{"line":1,"column":918}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":55,"column":32},"generated":{"line":1,"column":931}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":55,"column":32},"generated":{"line":1,"column":933}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":56,"column":18},"generated":{"line":1,"column":956}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":56,"column":22},"generated":{"line":1,"column":960}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":56,"column":22},"generated":{"line":1,"column":962}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":56,"column":60},"generated":{"line":1,"column":1000}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":56,"column":62},"generated":{"line":1,"column":1002}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":56,"column":71},"generated":{"line":1,"column":1010}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":56,"column":73},"generated":{"line":1,"column":1012}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":58,"column":18},"generated":{"line":1,"column":1018}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":62,"column":17},"generated":{"line":1,"column":1020}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":62,"column":21},"generated":{"line":1,"column":1024}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":62,"column":35},"generated":{"line":1,"column":1026}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":62,"column":64},"generated":{"line":1,"column":1028}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":62,"column":66},"generated":{"line":1,"column":1029}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":62,"column":80},"generated":{"line":1,"column":1042}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":62,"column":97},"generated":{"line":1,"column":1057}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":62,"column":123},"generated":{"line":1,"column":1060}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":64,"column":8},"generated":{"line":1,"column":1103}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":71,"column":12},"generated":{"line":1,"column":1107}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":64,"column":12},"generated":{"line":1,"column":1109}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":64,"column":24},"generated":{"line":1,"column":1111}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":64,"column":29},"generated":{"line":1,"column":1116}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":64,"column":42},"generated":{"line":1,"column":1129}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":79,"column":8},"generated":{"line":1,"column":1132}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":67,"column":13},"generated":{"line":1,"column":1139}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":67,"column":26},"generated":{"line":1,"column":1142}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":67,"column":33},"generated":{"line":1,"column":1149}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":67,"column":38},"generated":{"line":1,"column":1154}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":67,"column":43},"generated":{"line":1,"column":1159}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":67,"column":60},"generated":{"line":1,"column":1176}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":67,"column":69},"generated":{"line":1,"column":1183}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":68,"column":12},"generated":{"line":1,"column":1187}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":68,"column":24},"generated":{"line":1,"column":1189}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":68,"column":31},"generated":{"line":1,"column":1196}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":68,"column":36},"generated":{"line":1,"column":1201}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":68,"column":41},"generated":{"line":1,"column":1206}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":68,"column":58},"generated":{"line":1,"column":1223}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":75,"column":12},"generated":{"line":1,"column":1227}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":76,"column":12},"generated":{"line":1,"column":1231}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":76,"column":29},"generated":{"line":1,"column":1233}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":76,"column":34},"generated":{"line":1,"column":1238}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":76,"column":50},"generated":{"line":1,"column":1254}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":79,"column":12},"generated":{"line":1,"column":1258}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":81,"column":35},"generated":{"line":1,"column":1265}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":81,"column":16},"generated":{"line":1,"column":1269}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":81,"column":62},"generated":{"line":1,"column":1277}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":81,"column":48},"generated":{"line":1,"column":1281}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":81,"column":76},"generated":{"line":1,"column":1284}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":81,"column":81},"generated":{"line":1,"column":1286}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":81,"column":92},"generated":{"line":1,"column":1297}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":81,"column":105},"generated":{"line":1,"column":1307}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":81,"column":110},"generated":{"line":1,"column":1309}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":81,"column":121},"generated":{"line":1,"column":1320}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":96,"column":23},"generated":{"line":1,"column":1330}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":96,"column":23},"generated":{"line":1,"column":1332}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":96,"column":23},"generated":{"line":1,"column":1334}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":96,"column":29},"generated":{"line":1,"column":1343}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":96,"column":35},"generated":{"line":1,"column":1345}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":96,"column":42},"generated":{"line":1,"column":1352}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":96,"column":49},"generated":{"line":1,"column":1359}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":96,"column":51},"generated":{"line":1,"column":1360}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":96,"column":59},"generated":{"line":1,"column":1367}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":96,"column":68},"generated":{"line":1,"column":1374}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":97,"column":21},"generated":{"line":1,"column":1378}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":97,"column":27},"generated":{"line":1,"column":1384}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":97,"column":34},"generated":{"line":1,"column":1388}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":97,"column":40},"generated":{"line":1,"column":1394}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":97,"column":45},"generated":{"line":1,"column":1399}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":97,"column":58},"generated":{"line":1,"column":1412}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":83,"column":23},"generated":{"line":1,"column":1417}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":83,"column":27},"generated":{"line":1,"column":1421}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":83,"column":54},"generated":{"line":1,"column":1429}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":83,"column":55},"generated":{"line":1,"column":1430}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":83,"column":64},"generated":{"line":1,"column":1432}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":84,"column":20},"generated":{"line":1,"column":1437}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":84,"column":36},"generated":{"line":1,"column":1439}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":84,"column":52},"generated":{"line":1,"column":1455}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":84,"column":64},"generated":{"line":1,"column":1457}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":84,"column":70},"generated":{"line":1,"column":1460}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":84,"column":76},"generated":{"line":1,"column":1465}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":85,"column":24},"generated":{"line":1,"column":1469}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":85,"column":32},"generated":{"line":1,"column":1471}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":86,"column":28},"generated":{"line":1,"column":1472}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":86,"column":34},"generated":{"line":1,"column":1477}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":86,"column":41},"generated":{"line":1,"column":1479}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":87,"column":28},"generated":{"line":1,"column":1482}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":87,"column":37},"generated":{"line":1,"column":1490}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":88,"column":32},"generated":{"line":1,"column":1491}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":88,"column":48},"generated":{"line":1,"column":1506}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":88,"column":55},"generated":{"line":1,"column":1508}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":91,"column":23},"generated":{"line":1,"column":1516}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":91,"column":29},"generated":{"line":1,"column":1522}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":91,"column":34},"generated":{"line":1,"column":1525}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":91,"column":41},"generated":{"line":1,"column":1527}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":92,"column":19},"generated":{"line":1,"column":1533}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":92,"column":25},"generated":{"line":1,"column":1539}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":92,"column":32},"generated":{"line":1,"column":1543}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":92,"column":38},"generated":{"line":1,"column":1549}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":92,"column":43},"generated":{"line":1,"column":1554}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":92,"column":56},"generated":{"line":1,"column":1567}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":100,"column":17},"generated":{"line":1,"column":1572}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":106,"column":23},"generated":{"line":1,"column":1574}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":106,"column":27},"generated":{"line":1,"column":1578}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":106,"column":62},"generated":{"line":1,"column":1586}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":106,"column":63},"generated":{"line":1,"column":1587}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":106,"column":72},"generated":{"line":1,"column":1589}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":107,"column":20},"generated":{"line":1,"column":1594}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":107,"column":36},"generated":{"line":1,"column":1596}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":107,"column":45},"generated":{"line":1,"column":1605}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":108,"column":25},"generated":{"line":1,"column":1608}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":108,"column":31},"generated":{"line":1,"column":1613}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":109,"column":28},"generated":{"line":1,"column":1617}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":109,"column":36},"generated":{"line":1,"column":1619}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":110,"column":32},"generated":{"line":1,"column":1620}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":110,"column":38},"generated":{"line":1,"column":1625}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":110,"column":45},"generated":{"line":1,"column":1627}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":111,"column":32},"generated":{"line":1,"column":1630}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":111,"column":41},"generated":{"line":1,"column":1638}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":112,"column":36},"generated":{"line":1,"column":1639}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":112,"column":52},"generated":{"line":1,"column":1654}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":112,"column":59},"generated":{"line":1,"column":1656}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":116,"column":25},"generated":{"line":1,"column":1664}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":116,"column":31},"generated":{"line":1,"column":1670}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":118,"column":28},"generated":{"line":1,"column":1675}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":118,"column":34},"generated":{"line":1,"column":1681}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":118,"column":49},"generated":{"line":1,"column":1684}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":118,"column":49},"generated":{"line":1,"column":1686}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":118,"column":49},"generated":{"line":1,"column":1688}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":118,"column":55},"generated":{"line":1,"column":1697}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":118,"column":61},"generated":{"line":1,"column":1699}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":118,"column":68},"generated":{"line":1,"column":1706}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":118,"column":75},"generated":{"line":1,"column":1713}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":118,"column":77},"generated":{"line":1,"column":1714}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":118,"column":85},"generated":{"line":1,"column":1721}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":118,"column":94},"generated":{"line":1,"column":1728}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":119,"column":28},"generated":{"line":1,"column":1732}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":119,"column":41},"generated":{"line":1,"column":1734}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":119,"column":47},"generated":{"line":1,"column":1740}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":119,"column":52},"generated":{"line":1,"column":1743}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":119,"column":59},"generated":{"line":1,"column":1745}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":120,"column":28},"generated":{"line":1,"column":1749}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":120,"column":36},"generated":{"line":1,"column":1751}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":122,"column":19},"generated":{"line":1,"column":1758}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":122,"column":25},"generated":{"line":1,"column":1764}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":122,"column":32},"generated":{"line":1,"column":1768}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":122,"column":38},"generated":{"line":1,"column":1774}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":122,"column":43},"generated":{"line":1,"column":1779}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":122,"column":56},"generated":{"line":1,"column":1792}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":102,"column":23},"generated":{"line":1,"column":1798}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":102,"column":23},"generated":{"line":1,"column":1800}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":102,"column":23},"generated":{"line":1,"column":1802}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":102,"column":29},"generated":{"line":1,"column":1811}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":102,"column":35},"generated":{"line":1,"column":1813}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":102,"column":42},"generated":{"line":1,"column":1820}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":102,"column":49},"generated":{"line":1,"column":1827}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":102,"column":51},"generated":{"line":1,"column":1828}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":102,"column":59},"generated":{"line":1,"column":1835}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":102,"column":68},"generated":{"line":1,"column":1842}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":103,"column":21},"generated":{"line":1,"column":1846}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":103,"column":27},"generated":{"line":1,"column":1852}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":103,"column":34},"generated":{"line":1,"column":1856}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":103,"column":40},"generated":{"line":1,"column":1862}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":103,"column":45},"generated":{"line":1,"column":1867}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":103,"column":58},"generated":{"line":1,"column":1880}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":127,"column":17},"generated":{"line":1,"column":1887}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":127,"column":29},"generated":{"line":1,"column":1899}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":128,"column":8},"generated":{"line":1,"column":1942}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":128,"column":15},"generated":{"line":1,"column":1949}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":128,"column":20},"generated":{"line":1,"column":1954}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":128,"column":24},"generated":{"line":1,"column":1958}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":128,"column":30},"generated":{"line":1,"column":1965}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":128,"column":41},"generated":{"line":1,"column":1968}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":131,"column":11},"generated":{"line":1,"column":1973}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":131,"column":29},"generated":{"line":1,"column":1991}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":132,"column":15},"generated":{"line":1,"column":2001}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":132,"column":20},"generated":{"line":1,"column":2006}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":132,"column":36},"generated":{"line":1,"column":2022}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":139,"column":12},"generated":{"line":1,"column":2025}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":139,"column":25},"generated":{"line":1,"column":2038}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":141,"column":8},"generated":{"line":1,"column":2041}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":141,"column":14},"generated":{"line":1,"column":2047}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":141,"column":22},"generated":{"line":1,"column":2049}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":141,"column":27},"generated":{"line":1,"column":2051}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":141,"column":33},"generated":{"line":1,"column":2057}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":142,"column":14},"generated":{"line":1,"column":2062}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":142,"column":33},"generated":{"line":1,"column":2064}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":142,"column":39},"generated":{"line":1,"column":2066}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":142,"column":47},"generated":{"line":1,"column":2074}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":145,"column":8},"generated":{"line":1,"column":2085}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":145,"column":34},"generated":{"line":1,"column":2089}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":145,"column":12},"generated":{"line":1,"column":2093}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":145,"column":39},"generated":{"line":1,"column":2096}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":145,"column":45},"generated":{"line":1,"column":2098}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":145,"column":56},"generated":{"line":1,"column":2107}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":145,"column":75},"generated":{"line":1,"column":2109}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":145,"column":78},"generated":{"line":1,"column":2111}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":146,"column":12},"generated":{"line":1,"column":2112}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":146,"column":18},"generated":{"line":1,"column":2118}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":146,"column":30},"generated":{"line":1,"column":2120}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":146,"column":36},"generated":{"line":1,"column":2122}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":146,"column":55},"generated":{"line":1,"column":2124}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":148,"column":12},"generated":{"line":1,"column":2127}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":148,"column":17},"generated":{"line":1,"column":2131}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":148,"column":22},"generated":{"line":1,"column":2136}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":148,"column":38},"generated":{"line":1,"column":2152}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":148,"column":50},"generated":{"line":1,"column":2155}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":149,"column":12},"generated":{"line":1,"column":2162}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":149,"column":19},"generated":{"line":1,"column":2169}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":6,"column":0},"generated":{"line":1,"column":2173}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":6,"column":0},"generated":{"line":1,"column":2181}},{"source":"../../src/http-client/HttpClient.ts","name":null,"original":{"line":6,"column":0},"generated":{"line":1,"column":2192}}],"sources":{"../../src/http-client/HttpClient.ts":"import axios, { AxiosRequestConfig } from 'axios'\r\nimport { ShapeDiverError as ShapeDiverBackendError, ShapeDiverResponseError, ShapeDiverRequestError } from '@shapediver/sdk.geometry-api-sdk-v2'\r\nimport { ShapeDiverGeometryBackendRequestError, ShapeDiverGeometryBackendResponseError } from '../logger/ShapeDiverBackendErrors';\r\nimport { HttpResponse } from './HttpResponse';\r\n\r\nexport class HttpClient {\r\n    // #region Properties (2)\r\n\r\n    private static _instance: HttpClient;\r\n\r\n    private _sessionLoading: {\r\n        [key: string]: {\r\n            getAsset: (url: string) => Promise<[ArrayBuffer, string, string]>,\r\n            downloadTexture: (sessionId: string, url: string) => Promise<[ArrayBuffer, string]>,\r\n        }\r\n    } = {};\r\n\r\n    // #endregion Properties (2)\r\n\r\n    // #region Constructors (1)\r\n\r\n    private constructor() { }\r\n\r\n    // #endregion Constructors (1)\r\n\r\n    // #region Public Static Accessors (1)\r\n\r\n    public static get instance() {\r\n        return this._instance || (this._instance = new this());\r\n    }\r\n\r\n    // #endregion Public Static Accessors (1)\r\n\r\n    // #region Public Methods (5)\r\n\r\n    public addDataLoading(sessionId: string, callbacks: {\r\n        getAsset: (url: string) => Promise<[ArrayBuffer, string, string]>,\r\n        downloadTexture: (sessionId: string, url: string) => Promise<[ArrayBuffer, string]>,\r\n    }) {\r\n        this._sessionLoading[sessionId] = callbacks;\r\n    }\r\n\r\n    /**\r\n     * Maps the geometry backend error to the corresponding viewer errors:\r\n     * - ShapeDiverResponseError is mapped to ShapeDiverGeometryBackendResponseError\r\n     * - ShapeDiverRequestError is mapped to ShapeDiverGeometryBackendRequestError\r\n     * \r\n     * Other error types are thrown as is.\r\n     * \r\n     * @param e \r\n     */\r\n    public convertError(e: ShapeDiverBackendError | Error | unknown) {\r\n        if (e instanceof ShapeDiverResponseError) {\r\n            throw new ShapeDiverGeometryBackendResponseError(e.message, e.status, e.error, e.desc);\r\n        } else if (e instanceof ShapeDiverRequestError) {\r\n            throw new ShapeDiverGeometryBackendRequestError(e.message, e.desc)\r\n        } else {\r\n            throw e;\r\n        }\r\n    }\r\n\r\n    public async get(href: string, config: AxiosRequestConfig = { responseType: 'arraybuffer' }, textureLoading: boolean = false): Promise<HttpResponse<any>> {\r\n        // try to get sessionId from href\r\n        let sessionId = this.getSessionId(href);\r\n\r\n        // if href does not have sessionId, use the first session, if available\r\n        if (!sessionId && Object.keys(this._sessionLoading).length > 0)\r\n            sessionId = Object.keys(this._sessionLoading)[0];\r\n\r\n        // get the session loading functions, if available\r\n        let sessionLoading: {\r\n            getAsset: (url: string) => Promise<[ArrayBuffer, string, string]>,\r\n            downloadTexture: (sessionId: string, url: string) => Promise<[ArrayBuffer, string]>,\r\n        } | undefined;\r\n        if (sessionId)\r\n            sessionLoading = this._sessionLoading[sessionId];\r\n\r\n        // separation texture vs everything else\r\n        if (textureLoading) {\r\n            // if we have a sessionId and the sessionLoading functions and the image is not a blob or data, we load it via the sdk\r\n            if (sessionLoading !== undefined && sessionId !== undefined && !href.startsWith('blob:') && !href.startsWith('data:')) {\r\n                // take first session to load a texture that is not session related\r\n                return new Promise<HttpResponse<any>>((resolve, reject) => {\r\n                    sessionLoading!.downloadTexture(sessionId!, href).then((result) => {\r\n                        resolve({\r\n                            data: result[0],\r\n                            headers: {\r\n                                'content-type': result[1]\r\n                            }\r\n                        })\r\n                    }).catch(e => reject(e))\r\n                }).catch(e => { throw this.convertError(e) });\r\n            } else {\r\n                // we can load blobs and data urls directly\r\n                // or load it directly if we don't have a session\r\n                return axios(href, Object.assign({ method: 'get' }, config))\r\n                    .catch(e => { throw this.convertError(e) });\r\n            }\r\n        } else {\r\n            if (!sessionLoading) {\r\n                // if there is no session to load from, we use the fallback option\r\n                return axios(href, Object.assign({ method: 'get' }, config))\r\n                    .catch(e => { throw this.convertError(e) });\r\n            } else {\r\n                // all data links where we could somehow find a session to load it with\r\n                return new Promise<HttpResponse<ArrayBuffer>>((resolve, reject) => {\r\n                    sessionLoading!.getAsset(href)\r\n                        .then((result) => {\r\n                            resolve({\r\n                                data: result[0],\r\n                                headers: {\r\n                                    'content-type': result[1]\r\n                                }\r\n                            })\r\n                        })\r\n                        .catch(() => {\r\n                            // if this fails, we just load it directly\r\n                            const axiosPromise = axios(href, Object.assign({ method: 'get' }, config));\r\n                            axiosPromise.catch(e => reject(e))\r\n                            resolve(axiosPromise);\r\n                        });\r\n                }).catch(e => { throw this.convertError(e) });\r\n            }\r\n        }\r\n    }\r\n\r\n    public async loadTexture(href: string): Promise<HttpResponse<ArrayBuffer>> {\r\n        return this.get(href, undefined, true);\r\n    }\r\n\r\n    public removeDataLoading(sessionId: string) {\r\n        delete this._sessionLoading[sessionId];\r\n    }\r\n\r\n    // #endregion Public Methods (5)\r\n\r\n    // #region Private Methods (1)\r\n\r\n    private getSessionId(href: string): string | undefined {\r\n        // searching for \"/session/SESSION_ID/{'output' | 'export' | 'texture'}/ASSET_DATA\"\r\n        const parts = href.split('/');\r\n        const sessionPartIndex = parts.indexOf('session');\r\n\r\n        // There have to be at exactly 4 parts, including the session\r\n        if (sessionPartIndex !== -1 && parts.length === sessionPartIndex + 4) {\r\n            const sessionId = parts[sessionPartIndex + 1];\r\n            // no such session has been registered, should never happen\r\n            if (!this._sessionLoading[sessionId]) return;\r\n            return sessionId;\r\n        }\r\n        return;\r\n    }\r\n\r\n    // #endregion Private Methods (1)\r\n}"},"lineCount":null}},"error":null,"hash":"5c8ad5159c064bdf9aeeceea31db1055","cacheData":{"env":{}}}